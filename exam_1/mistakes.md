## 質問3
>A社ではアプリケーション開発においてAWSのcodeシリーズと呼ばれるAWS CodeCommitとAWS CodeDeployなどを利用して開発・テスト・デプロイまでのパイプラインを利用したCI/CDを整備しています。CodeDeployによってデプロイを実行した際に、デプロイが成功したかどうかを担当者が確認することが必要です。

>この要件を達成するためにCodeDeployの設定において、実施すべき対応を選択してください。

*A: .appspecファイルをルートディレクトリに定義する*

***
note:

* .appspecファイルをルートディレクトリに定義することで、CodeCommitとCodeDeployの設定に対して、アプリケーションのデプロイ時にファイルへのアクセス許可を変更して、デプロイを制御することができるようになる
* CodeDeployの設定は.appspecファイル
* AppSpec は AWS CodeDeploy で実行するデプロイ処理の内容を設定するYAML ファイル


## 質問4

>あるベンチャー企業ではAWSを利用したCI/CD環境を構築しています。開発環境などはAmazon ECSを利用して全てDocker形式で展開できるようにしています。あなたは開発担当者として、コンテナの設定としてタスクの割り当てを別々に設定したいと考えております。コンテナーのタスク割り当てで資格情報を分割する方法が必要です。

>この設定のために、どのアクションを実行することが必要となりますか？

*A: ECSに対してIAMロールを作成してタスクに割り当てる*

***
note:

* Amazon ECSにおいてコンテナが別のタスクに属する別のコンテナの資格情報へのアクセスを制御するにはアクセス許可の設定が必要（各コンテナには各ロールが必要ってこと）
* ECSのコンテナエージェントはユーザーに代わってECS APIを実行するためにIAMロールが必要
* このIAMロールはタスク実行IAMロールという
* 複数のタスク実行ロールを、アカウントに関連付けることができECSのタスクを複数実行できるようになる

## 質問7

>あなたの会社では顧客データを保存するためにAmazon S3を利用しています。顧客データはセキュリティを強固にする必要があるため、アクセスログを有効にしてステータスについて確認できるような設定をしました。バケットのデータ増加は一週間で1GBほどですが、アクセスログをオン後にバケットのサイズが３日で10GB増加したようです。

>このデータ増加の原因として考えられる要因を説明してください。

*A: サーバーアクセスログはS3バケットを利用するだけでもアクセスログを増加させる*

***
note:

* サーバーアクセスログはストレージデータの増加がデメリット
* サーバーアクセスログはアクセスログのレコードごとに 1 つのアクセスリクエストの詳細として、リクエスタ、バケット名、リクエスト時刻、リクエストアクション、レスポンスのステータス、エラーコード (存在する場合) などの情報が取り込まれる。 ソースバケットとターゲットバケットが同じである場合、バケットに書き込まれるログに関する追加のログが作成される。これにより、利用が頻繁であればあるほどS3バケットにログデータが追加される
つまりソースとそれに対するアクセスログが自分自身の場合には2倍のアクセスログになるということ

## 質問9
>A社では社内の文書共有システムとしてS3をストレージに利用しています。社内の方針で個人PCに保存しているドキュメントを個人管理用のストレージエリアに保存することが決定されました。そのためには、AWSアカウントによって定義されたユーザー全てに、S3バケットに個人用の保存スペースを設定することが必要です。

>この個人用スペースをセットアップする最適な方法を選択してください。

***
note:

*A: 動的変数を使用してIAMポリシーを一つ作成し、全てのユーザーの属するIAMグループにアタッチする*

* 動的変数を使用してIAMポリシーを1つ作成し（一個のルール）、全てのユーザーの属するIAMグループにアタッチすること（全員にそれを反映）でS3バケットに個人用スペースをセットアップすることができる
* IAMポリシーのJSONに各ユーザーに適用できるような動的変数を使用したIAMポリシーを設定して、S3バケットにおいてS3バケット個人用スペースの読み取り、および書き込みの許可を与える

## 質問10
>あなたはAWS専門のエンジニアとして、IoTデータをキャプチャしてAmazon Kinesis Data Streamsに送信するモバイルアプリケーションを構築しました。このアプリケーションは、EC2インスタンスでKCLベースでKinesisと連携しています。最近になって利用ユーザーが増加したことで、Kinesis Data Streamにおけるトラフィックが増加したため、あなたはシャードを分割して6シャードから10シャードに増強しました。

>シャードを処理するためにデプロイできるEC2インスタンスの最大数はいくつですか？

*A: 10*

***
note:

* Kinesisはシャードからなるストリームを作成してストリーミングデータを保持して処理する
* 1シャードにつき1EC2を割り当てられるため、10になる

## 質問11
>あなたはAWS専門のエンジニアとして、AWSリソースのセットアップを実施しています。あなたはアプリケーションCLIオプションの設定で、DynamoDBのアプリケーション上の読み込み設定を行っています。DynamoDBスキャンを実行し、特定の属性サブセットを取得する対応が必要です。

>この操作を完了するための適切なCLIコマンドを選択してください。

*A: --projection-expression*

***
note:

* KVSのDynamo DB デフォルトで全ての属性を取って来ちゃうのである特定の属性のみを取り出すには--projection-expression
* 使用例は
```
aws dynamodb get-item \
--table-name ProductCatalog \
--key '{"Id":{"N":"123"}}' \
--projection-expression "Safety.Warning"
```

## 質問12
>あなたはソリューションアーキテクトとして、MongoDB Atlasに接続するLambda関数を構築しました。これは、一般的なデータベースのサービスプラットフォームであり、サードパーティAPIを使用して特定のデータを取得することもできます。 現在、あなたは「MongoDBデータベースのホスト名、ユーザー名、およびパスワードの環境変数」と、「Lambda関数で使用されるAPI資格情報」を作成する対応を行っています。その際にチーム外の開発者がプレーンテキストで環境変数を参照できないようにするために、最大限のセキュリティを確保することをユーザー側から求められました。

>このセキュリティ要件を満たす設定方法を選択してください。

*A: AWS KMSを新しく利用して、伝送中の暗号化のためのヘルパーを有効化する*

***
note:

* Lambdaで環境変数を使用するにはAWS KMSを使用して環境変数を暗号化する
* それをLambdaで利用するように設定すると復号化されて使える

設定方法
```
・AWS Lambdaの環境変数のセクションで、[暗号化の設定]を展開します。

・「伝送中に暗号化するKMSキー」と「保管時に暗号化するKMSキー」に先ほど作成したKMSキーを選択します。「伝送中の暗号化のためのヘルパーの有効化」にチェックを入れると環境変数の横に[暗号化]、[コード]のボタンが現れます
```

## 質問13
>A社はAWS LambdaとAPI GatewayおよびDynamoDBで構成したサーバーレスアーキテクチャを利用しています。Lambda関数は顧客ファイルを処理しており、多くの中間ファイルを作成しています。したがって、実行完了後に破棄されるLambda関数の一時ファイルを保存する必要があります。

>次の中で最適なLambda関数の一時ファイルの保存場所を選択してください。

*A: ローカルディレクトリの/tmpを利用する*

***
note:

* Lambdaで一時的なファイルを保存できる場所は/tmp
* 容量は最大512MB

## 質問14
>あなたはオークションアプリケーションを構築しています。データ保存とアクセスにDynamoDBを使用して、可用性の高いWebアプリケーションとする必要があります。オークションアプリケーションのDynamoDBには入札情報を保存しますが、入札は一時的な処理であるため、コスト効率の観点からもオークション実行後にDynamoDBテーブルデータを自動的に失効させたいと考えています。

>この要件を達成するDynamoDBテーブルの設定方法はどれでしょうか？

*A: TTL*

***
note:

* TTL【 Time To Live 】 生存時間
* TTLをDynamoDBで有効にすると特定のテーブルの項目に有効期限を設定できる
* TTLはテーブルの項目ごとにタイムスタンプで設定でき、契約または規制上の義務に従って特定の期間のみ保持する必要がある重要なデータがある場合、TTL を使用することで予定に沿ってデータを削除することができる

## 質問15

>あなたはAWSを得意としたアプリケーション開発エンジニアです。現在、ECSコンテナーを利用したアプリケーションを運用していますが、不具合の確認にはX-Rayを利用することが必要です。X-RayデーモンがECSで正しく検出されるように設定が必要です。

>この要件を達成するためのAWS X-Ray SDKの環境変数はどれでしょうか？

*A: AWS_XRAY_DAEMON_ADDRESS*

***
note:

* X-RayはLambdaのモニタリングのサービス
* X-Rayでログを取るにはデーモンを起動する必要があり、Lambdaのリソースが自動的に使われる
* AWS X-Ray SDKにおいてAWS_XRAY_DAEMON_ADDRESS 環境変数を設定することが必要
```
Amazon ECS で、X-Ray デーモンを実行するためには、 実行用のDocker イメージを作成し、それを Docker イメージリポジトリにアップロードして、Amazon ECS クラスターにデプロイできます。タスク定義ファイルでポートマッピングとネットワークモード設定を使用すると、アプリケーションがデーモンコンテナと通信できるようになります。 このためには、 ポートマッピング、リンク、および AWS_XRAY_DAEMON_ADDRESS 環境変数でホストポートを省略する設定が求められます。
```
