## 質問1
>ヘルステックベンチャーB社ではAWS上で体調管理アプリケーションの開発を行っています。このアプリケーションは世界的に使用されており、ユーザーがサブスクリプションで支払いを行っています。開発中の外部連携機能において API gatewayで作成されたパブリックAPIを公開することが必要です。

>この要件を満たすために必要なAPI gatewayの設定を選択してください。

*A: API Gateway使用料プラン*

***
note:

>API Gateway 使用量プランを利用することで、ビジネス要件および予算の制約に合った承認済みのリクエストレートとクォータによって選択した API へのアクセスを許可する設定ができます。これによって、必要に応じて、API のデフォルトのメソッドレベルのスロットリング制限を設定したり、個別の API メソッドのスロットリング制限を設定したりできます。

## 質問2
>あなたの会社はCloudFormationテンプレートを利用してリソースをセットアップしています。 AWSリソースはコードを使用して定義され、条件に基づいてプロビジョニングされます。 あなたはエンジニアとして、適切な条件設定をコード化して、CloudFormationテンプレートを準備しています。

>CloudFormationテンプレートで条件を評価するためのセクションを選択してください。

*A: Parametersセクション*

***
note:

* Parametersセクションで条件がtrueの場合にリソースを作るといったことができる

>CloudFormationの各セクションは次のような内容を担っています。<br>
Parametersセクション：
条件において評価する入力を定義します。これらの入力パラメータの値に基づいて、条件は true または false と評価されます。条件で擬似パラメータを評価する場合は、このセクションで擬似パラメータを定義する必要はありません。擬似パラメータはCloudFormation によって事前定義されています。 <br>
Conditionsセクション<br>
組み込み関数を使用して条件を定義します。これらの条件はCloudFormation が関連するリソースをいつ作成するかを指定します。 <br>
Resources および Outputsセクション<br>
条件付きで作成するリソースまたは出力と条件を関連付けます。CloudFormation は、true に関連付けられたエンティティを作成し、false に関連付けられたをエンティティを無視します。Condition キーと条件の論理 ID を使用して、リソースまたは入力と関連付けます。条件付きでプロパティを指定するには、Fn::If 関数を使用します。

## 質問5
>あなたはAWS開発者として社内のアプリケーション開発に携わっています。現在は、オンプレミス環境のLinuxサーバーで実行されるJAVAアプリケーションを開発しています。アプリケーションは、AWS SDK for JAVAを使用して、オンプレミス環境からS3、DynamoDB、RDSなどと連携する必要があります。

>このアプリケーション開発に必要な開発者へのアクセス権限設定として、最も適切な方法を選択してください

*A: 開発者に必要なAWSサービスへのアクセス権限を付与したIAMユーザーを作成する。次にアプリケーションサーバーでIAMユーザーのアクセススキーを使用して~/.aws/credentialsに認証ファイルを作成する*

***
note:

* オンプレミスからのためロールだけ与えてもダメ
* IAMユーザーのIDとSecretをcredentialsに入れるとアクセスできる

## 質問8
>あなたはソリューションアーキテクトとして、ECサイトを構築しています。このサイトはEC2インスタンスにAuto Scalingグループを適用して構成されており、データベースとしてAmazon Aurora PostgreSQLを使用しています。 このデータベース処理では次のように処理を分ける必要があります。

>１．プロダクショントラフィックの書き込み操作は大容量インスタンスが処理<br>
２．社内スタッフが管理用におこなったレポートクエリは小容量インスタンスが処理

>この要件を満たすために、アプリケーションとAuroraデータベースクラスタの最適な構成を選択してください。

*A: Auroraで新しいカスタムエンドポイントを作成して、両方のトラフィックを処理できるように構成する*

***
note:

* 新たにカスタムエンドポイントを作成して元のエンドポイントと合わせて２つの接続で処理をする

>Amazon Auroraは通常、単一のインスタンスではなくDBインスタンスのクラスターを構成します。 各接続は特定のDBインスタンスによって処理されます。 Auroraクラスターに接続すると、指定したホスト名とポートはエンドポイントと呼ばれる中間ハンドラーを指します。 Auroraはこれらの接続を抽象化するためにエンドポイントメカニズムを使用します。これを使って、Auroraで新しいカスタムエンドポイントを作成して、両方のトラフィックを処理できるように構成することが可能です。

## 質問10
>あなたはAWSを利用してサーバレスアプリケーションを構築している開発者です。Lambda関数をAWSにデプロイするためにCloudFormationテンプレートを作成しています。 CloudFormaitonテンプレートにコードを配置するためにAWS :: Lambda :: Functionリソースのパラメーター設定が必要です。

>どのようなパラメーター設定をするべきでしょうか？

*A: ZipFile*

***
note:

* Lambda 関数のデプロイパッケージでは、Amazon S3 内のオブジェクトの場所を指定できる
* AWS CloudFormationはLambdaをS3のindexという名前のファイルに配置し、zip化して展開パッケージを作成する

## 質問12
>A社ではAWSのサーバレスアーキテクチャを活用した処理の自動化を行っています。あなたはAWS開発者として、Amazon API Gatewayによって起動されるAWS Lambda関数を開発しており、新APIバージョンをテストしたいと考えています。

>Lambda関数の既存バージョンと並行して、新バージョンを上手くテストする方式はどれでしょうか？

*A: エイリアスを利用してAPI Gatewayのカナリアリリースを実施する*

***
note:

>新しいバージョンがCanaryリリースとしてデプロイされると、以前のベースバージョンは同じステージで通常のオペレーションのために、本稼働版としてデプロイされたままになります。エイリアスには Additional versionというオプションが存在し、主として指定したVersionとは異なるVersionとその呼び出し割合を指定することができます。

## 質問13
>あなたはエンジニアとして、AWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成したサーバーレスアーキテクチャの初期展開の準備をしています。API GatewayとLambdaとを連携するためにはAPI Gatewayにステージを追加して、Lambda関数の環境設定を関連付けることが必要です。

>これを実現するには、 Lambda 関数のどの設定を追加する必要がありますか？ （2つ選択してください。）

*A: ステージ変数、Lambdaエイリアス*

***
note:

* API Gatewayで指定したバージョンのステージ変数とLambdaのエイリアスであるprodやdevがどのバージョンなのかを紐付ける設定をする

>Lambda 関数では 1 つ以上のエイリアスを作成できます。AWS Lambda エイリアスは Lambda 関数の特定のバージョンに対するポインタのようなものです。エイリアスを使用すると、新しいLambda関数バージョンを昇格させるプロセスを抽象化でき、新しいバージョンよりも管理しやすくなります。 したがって、Lambda エイリアスを設定することで、Lambda 関数の特定のバージョンを認識することができ、バージョンを一致させることができるようなります。

>API Gatewayのステージ変数は、REST API のデプロイステージと関連付けられた設定属性として定義できる名前と値のペアです。環境変数と同様に機能し、API のセットアップやマッピングテンプレートで使用できます。たとえば、ステージ設定でステージ変数を定義し、REST API のメソッド用に、HTTP 統合の URL 文字列を値として設定できます。これによって、API のセットアップから関連するステージの変数名を使用して URL 文字列を参照できます。これによって、ステージ変数の値に対応する URL をリセットすることで、各ステージで異なるエンドポイントとともに同じ API セットアップを使用することができます。AWS Lambda には AWS Lambda エイリアスを利用してパラメーターが渡されます。

## 質問14
>あなたはLambda 関数で取り扱うデータを暗号化する設定を行っています。暗号化にはAWS KMSを使用してネットワーク経由で転送される大きなJSONファイルを暗号化し、本番に進む前にアプリケーションをテストしたいと考えています。これには適切なKMSのデータサイズに基づいた設定が必要となります。 

>AWS KMSの最大データサイズを選択してください。

*A: 4KB*

***
note:

* 暗号化オペレーションに AWS KMS カスタマーマスターキー (CMK) を使用しますが、KMSは4 KB (4096 bytes) 以上のデータを受け付けない

## 質問15
>企業はAWS上でCodeシリーズを利用してCI / CD開発環境を整備して、アプリケーションを構築しています。アプリケーションはCodeDeployによって最適な展開方式を設定しています。デプロイ中に失敗し、AWS CodeDeployの処理がロールバックされました。 

>ロールバック時のデプロイIDは次のうちどれですか？

*A: 新しいデプロイID*

***
note:

>以前にデプロイされたアプリケーションのリビジョンを新しいデプロイとして再デプロイすることによって、デプロイをロールバックします。これらのロールバックされたデプロイは、前のデプロイのバージョンを復元するのではなく、新しいデプロイ ID を使用する技術的に新しいデプロイです。 

## 質問17
>あなたはAWS専門のエンジニアとして、車両データをキャプチャしてAmazon Kinesis Data Streamsに送信するモバイルアプリを構築しています。アプリでデータ呼び出しを実行したところ、ProvisionedThroughputExceededExceptionエラーで拒否されてしまいました。調査したところKinesis側のストリーム処理としては問題ないパフォーマンスが担保されており、ストリーム処理されたデータを連携する処理において問題が発生しているようです。

>この問題に対して、コストを最小限に抑えつつ実施できる対応策を選択してください 。（2つ選択してください。）

*A: エクスポネンシャルバックオフの実施、Lambdaによるバッチ並行処理の利用*

***
note:

* ProvisionedThroughputExceededExceptionエラーは、大量のデータを処理できていない
* PutRecord要求を処理できない場合か、またはその後のGetRecord処理に対応するパフォーマンスがない
>エクスポネンシャルバックオフは、再試行間の待機時間を累進的に長くして、連続的なエラー応答を受信するという考えに基づいています。最大遅延間隔で最大回数の再試行を実行する必要があります。再試行の最大遅延間隔と最大回数は必ずしも固定値ではなく、実行する操作や局所的な要因 (ネットワークのレイテンシーなど) に基づいて設定する必要があります。

>KinesisのGetRecord処理をする際にデータをとりだす単位をバッチと呼んでいます。その際のバッチ処理を高速分散化させることで、エラーを回避させることができます。ProvisionedThroughputExceededExceptionエラーへの対処として、データレコードを取得するバッチのサイズを変更したり、バッチ処理を並行化することでGetRecordの要求増に対応することができるようになります。

## 質問18
>B社ではAPIコールでDynamoDBテーブルからデータを取得するサーバレスアプリを実装しています。あなたはサーバレスエンジニアとして、開発環境でAPIに取り組んできましたが、行った変更はAPIに反映されていないようです。 

>変更をAPIに反映させるために必要な手順を選択してください。

*A: ステージへのデプロイ*

***
note:

* ステージはデプロイへの名前を付けたリファレンスであり、 API のスナップショット
* ステージを使用してテストのために Canary リリースを行ったりできる
* API Gatewayはメソッドの変更、統合、承認者、およびステージ設定以外のものを含むAPIを更新するたびに、既存のステージまたは新しいステージにAPIを再デプロイする必要があります。 APIが進化するにつれて、APIのさまざまなバージョンとしてさまざまな段階にデプロイし続けることになる

## 質問19
>あなたはAWSを得意としたアプリケーション開発エンジニアです。現在は先月リリースしたAWS Lambda関数の不具合の改修や新規リリース向けの追加開発を実施しています。不具合の確認にはX-Rayを利用しています。X-Rayにデータを送信するために、Lambda関数にアタッチされたIAMロールを変更して、Lambda関数にX-Rayの実行に必要なアクセス権限を付与しましたが、X-Ray SDKを適用して挙動テストを実施したところ、データがX-Rayに送信されませんでした。

>この問題の原因として可能性が高い内容を選択してください。

*A: Lambda X-Rayトレースが有効化されていない*

***
note:

* 今回はすでにX-Rayは設定されており、デーモンは起動ずみ
* Lambda X-Ray トレースが有効化されていないと、データがX-Rayに送信されない
* Lambda関数でトレースを有効にするには、Lambda関数の実行ロールにトレース許可を追加する

## 質問21
>あなたはElastic Beanstalkを利用して、WEBアプリケーションを展開しています。先日、このWEBアプリケーションの処理が遅延しているというクレームが業務担当者からよせられました。障害解析をしてみると、CPUの利用率が100％かそれに近い水準まで上昇していることがわかりました。

>この問題を解決する方法を選択してください。

*A: CPUをモニタリングしたElastic Beanstalkのオートスケーリングを設定する*

***
note:

> Elastic Beanstalkには環境内の Amazon EC2インスタンスを管理する Auto Scaling グループを設定することができます。単一インスタンス環境では、Auto Scaling グループに対して常に1 つのインスタンスが実行されます。負荷分散される環境では、実行する範囲のグループを設定すると、Auto Scalingは負荷に基づき必要に応じてインスタンスを追加または削除します。

* CloudWatchイベントによりモニタリングしたCPU状態に応じた通知を行うことが出来るが、スケーリングを実施するわけではない。

## 質問25
>あなたはサーバレスを得意とした開発者としてA社で勤務しています。現在、A社ではAWS CloudFormationを使用してLambdaをアップロードおよび更新する設定を行っています。

>CloudFormationにおいてLambda関数を設定する方法を選択してください。（2つ選択してください。）

*A: Lambda関数コードをzip化してS3にアップロードし、CloudFormationのAWS::Lambda::Functionにおいて参照する*<br>
*依存関係がない場合は、CloudFormationのAWS::Lambda::FunctionにLambda関数コードを記述する*

***
note:

* Lambdaに置かれたコードをそのままCloudFormationでは参照できず、zip化してS3に置いて参照する必要がある
* またCloudFormationに直接Lambdaを書けるのは、依存関係がない場合のみ！

## 質問28
>B社はAmazon SQSを利用した顧客からのリクエストを処理するアプリケーションを開発しています。Client_idごとにメッセージ順序が前後しないようにキューを処理するために、FIFOキューを選択しました。 あなたはエンジニアとして、FIFOキューの順序を保証する設定を依頼されました。

>次の中から、どのメッセージパラメータの値をClient_idに設定する必要がありますか？

*A: メッセージグループID*

***
note:

* メッセージグループ ID は 特定のメッセージグループに属するメッセージを指定するタグ
* 同じメッセージグループに属するメッセージは、メッセージグループに相対的な厳密な順序で、常に 1 つずつ処理されFIFOが実現できる

## 質問29
>あなたはS3に格納してある大量の顧客リストに対して、リストコマンドを実行しましたが、ページサイズが大きすぎてエラーが発生してしまいました。対応として、使用するAPIコール数を最小限に抑えてページ数を区切ることが必要です。したがって、S3から出力されるリスト結果をページ分割するCLIコマンドを実行します。

>どのCLIオプションを使用する必要がありますか？ （2つ選択してください。）

*A: --max-items,--page-size*

***
note:

* デフォルトでは、AWS CLI は 1,000 のページサイズを使用して、利用可能な全ての項目を取得する
* --max-items で項目数の指定、--page-sizeでAWS CLI が AWS のサービスの 1 回の呼び出しで要求する項目数を少なくすることができる
* --page-sizeを指定して細かく呼び出すことでエラーを回避する

## 質問30
>B社ではAWSを利用したCI/CD環境を構築しています。開発環境はCodeDeployを使用して、EC2インスタンスにアプリケーションをデプロイします。デプロイプロセスでは、appspec.ymlファイルを使用してデプロイフックを指定して、ライフサイクルイベントを設定して、適切なイベント処理を実行することが求められています。イベント要件として、デプロイされるLambda関数バージョンがシフトする前に、SNSによって通知を実施するタスクを設定する必要があります。

>どのデプロイのライフサイクルイベントを構成する必要がありますか？

*A: BeforeAllowTraffic*

***
note:

* BeforeAllowTrafficというライフサイクルイベントを利用すると、トラフィックがデプロイされたLambda関数バージョンに移行する前にタスクを実行する
* つまりデプロイしてTrafficが来る前に実行するタイミングなので、Lambda関数バージョンがシフトする前にSNSによって通知を実施するタスクを設定するといのに合致する

>■BeforeAllowTraffic
トラフィックがデプロイされたLambda関数バージョンに移行する前にタスクを実行するために使用します。

>■ValidateService
デプロイが正常に完了したことを確認するために使用されます。

>■BeforeInstall
インストール前にタスクを実行するために使用する

>■AfterAllowTraffic
トラフィックがデプロイされたLambda関数バージョンに移行する後にタスクを実行するために使用します

## 質問31
>A社はAWSのサーバレスアーキテクチャを社内で新規採用することになり、AWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成した新しいサーバーレスアーキテクチャを実装することになりました。あなたはエンジニアとして、OAuthまたはSAMLに類似した認証方式によってAPIリクエストへの認証を提供し、APIへのアクセスを制御する設定を行っています。

>この要件を達成するため最適な方法を選択してください。

*A: トークンベースのLambdaオーソライざー*

***
note:

* Lambda オーソライザーは、Lambda 関数を使用して API へのアクセスを制御する API Gateway の機能 2種類ある

>■トークンベース の Lambda オーソライザー (TOKEN オーソライザーとも呼ばれる)<br>
JSON ウェブトークン (JWT) や OAuth トークンなどのベアラートークンで発信者 ID を受け取ります。

>■リクエストパラメータベースの Lambda オーソライザー (REQUEST オーソライザーとも呼ばれる)<br>
ヘッダー、クエリ文字列パラメータ、stageVariables、および $context 変数の組み合わせで、発信者 ID を受け取ります。 

## 質問33
>ある企業ではEC2インスタンスにホストされているWebアプリケーションを運用しています。 あなたはソリューションアーキテクトとして、現在このアプリケーションに対して、EC2インスタンスのパブリックIPアドレスとプライベートIPアドレスを必要とするシェルスクリプトを作成しています。

>シェルスクリプトで使用できるインスタンスの関連IPアドレスを取得する最良の方法を選択してください。

*A: CurlまたはGetコマンドを利用して、169.254.169.254/latest/meta-data/から直近のメタデータを取得する*

***
note:

> インスタンスメタデータは実行中のインスタンスから取得できるため、Amazon EC2 コンソールまたは AWS CLI を使用する必要はありません

> IP アドレス 169.254.169.254 は、リンクローカルアドレスで、インスタンスからのみ有効です。したがって、CurlまたはGetコマンドを利用して、169.254.169.254/latest/meta-data/から直近のメタデータを取得する

## 質問34
>A社ではS3を利用したデータ共有システムを構築しています。セキュリティ要件としてデータ暗号化が必須となっており、あなたはエンジニアとして、クライアントが提供する暗号化キー（SSE-C）を使用したサーバーサイド暗号化をS3バケットに実装しています。このS3バケットにデータを適切にアップロードするには、リクエストにヘッダーを含める設定が必要です。

>この要件に対応して設定するべきヘッダーを選択してください。（3つ選択してください。）

*A: x-amz-server-side-encryption-customer-key-MD5*<br>
*x-amz-server-side-encryption-customer-key*<br>
*x-amz-server-side-encryption-customer-algorithm*

***
note:

* S3にあげるときに暗号化キーを使用して暗号化するには、暗号化キーの情報を指定するために3つのリクエストヘッダーを使用する

>■x-amz-server-side​-encryption​-customer-algorithm<br>
暗号化アルゴリズムを指定するには、このヘッダーを使用します。ヘッダーの値は "AES256" である必要があります。 

>■x-amz-server-side​-encryption​-customer-key<br>
Amazon S3 でデータを暗号化または復号するために使用する base64 でエンコードされた 256 ビットの暗号化キーを指定するには、このヘッダーを使用します。 

>■x-amz-server-side​-encryption​-customer-key-MD5<br>
RFC 1321 に従って、暗号化キーの base64 エンコードされた 128 ビット MD5 ダイジェストを指定するには、このヘッダーを使用します。Amazon S3 では、このヘッダーを使用してメッセージの整合性を調べて、送信された暗号化キーにエラーがないことが確認されます。 

## 質問35
>A社では開発環境などは全てDocker形式で展開できるようにAmazon ECSを使用してDockerアプリケーションを構築しています。このアプリケーションではFargate起動モードを使用しています。アプリケーションには３つの異なるタスクがあり、各タスクは他のタスクとは異なるさまざまなAWSリソースにアクセスします。

>ECSに対するAWSリソースへのアクセス許可設定として最適な設定を選択してください。

*A: 3つのIAMロールを作成して、各タスクで使用するAWSリソースへの許可をそれぞれ設定し、3つのECSタスクに設定する*

***
note:

* タスクの分割はタスク定義で実施するのではなく、IAMロールを分割することで実施可能

## 質問36
>ある会社ではAWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成した新しいサーバーレスアーキテクチャを構築しています。アプリケーションの実装においては、LambdaをAPI Gatewayと統合して、GetCustomerリソースによるGETメソッドを公開してLambda関数を呼び出し、コンシューマーがJSON形式でDynamoDBからデータリストを取得します。その際のAPIリクエストにはクエリ文字列パラメーターを含める必要があります。

>この要件を達成するための最適な設定方法を選択してください。

*A: リソースのメソッドリクエストをセットアップする*

***
note:

* API Gatewayは入口なだけのため、HTTP等できたものを裏で実行できるようにするのとそのレスポンスを定義する必要がある

>新しいまたは選択された API Resource の固有の HTTP 動詞になる API メソッド リソースを作成する場合、以下のサブタスクの実行が必要となります。<br>
・HTTP メソッドをメソッドリクエストに追加する<br>
・リクエストパラメーターを設定する<br>
・リクエストボディのモデルを定義する<br>
・認証スキームを実行する<br>
・リクエストの検証を有効化する
