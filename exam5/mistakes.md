## 質問1:不正解
>あなたはサーバレスアーキテクチャを構築しているA社のエンジニアです。現在はSQSキューを利用したマイクロサービスの開発を実施しています。SQSコンシューマーがメッセージ処理に設定以上の時間を要しており、重複したメッセージを受信するトラブルが発生しています。

>この問題を解決するために、最適な対応を選択してください。

*A: ChangeMessageVisibility APIをコンシューマレベルで使用する*

***
note:

* 可視性タイムアウトは事前にSQSのキューの処理の時間が分かっている場合に設定できる
* SQSキューを処理するコンシューマレベルでChangeMessageVisibility APIを設定することで、コンシューマの処理状況に合わせて動的に時間を延長できる

## 質問2:不正解
>ある会社ではモバイルデバイスとWebブラウザーからHTTPSトラフィックを受信する高可用性アプリケーションを開発しています。EC2インスタンスのWebサーバーとモバイルにアクセスするルーティング設定を現在の設定から、api.pintor.comおよびmobile.pintor.comに転送される設定することになりました。

>この要件を満たすことができる設定方法を選択してください。

*A: ホスト名とURLパスに基づいて転送ルールを設定する*

***
note:

* ホスト名とURLパスに基づいて転送ルールを設定することを、パスベースルーティングという
* マイクロサービスとかだとパスベースルーティングを使用して、トラフィックを複数のバックエンドサービスにルーティングできる

>ex)
>/txt/txt.html → alb1
>/img/img.html → alb2

>たとえば、一般的なリクエストを1つのターゲットグループにルーティングし、画像をレンダリングするリクエストを別のターゲットグループにルーティングできます。

## 質問3:不正解
>B社はモバイルデバイスとWebブラウザから利用するWEBアプリケーションを開発しています。 データベースとしてRDS MySQL5.7を利用しており、高速処理を実現するためにデータベースコールからデータ処理結果をキャッシュするマルチスレッドイベントベースのキャッシュストアを必要としています。 キャッシュレイヤー用に複数のコアを備えた大きなノードを実行する必要があります。

>この要件を満たすことができる適切なAWSサービスはどれですか？

*A: ElastiCache Memcached*

***
note:

* Redisはレプリケーションによるクラスターを組んで、冗長的な構成にできるがそのためレプリカ元のプライマリノードのみのシングルスレッドサーバーになってしまう（受け口が一個）

* Redisはキャッシュ版のマネージドに冗長を組んでくれるRDSみたいなイメージ

* Redisもスケールアウトできるが冗長化のために回されるため、複数のCPUの恩恵は得られない

* Memcachedはマルチスレッドだが、レプリケーションはなく各ノードで独立している

* Memcachedはスケールアウトによりマルチスレッドの数を増やすことできる

## 質問4:不正解

>A社ではAPI GatewayからLambdaを呼び出して、DynamoDBへとデータを記録・取得するサーバーレスアプリケーションを新しく作成されたAWSアカウントで東京リージョンにデプロイしました。これは2つの同一のLambda関数を使用してアドホックリクエストを処理する構成となっています。 最初のLambda関数は着信要求を効率的に処理しますが、2番目のLambda関数はスロットルメトリックスが長くなっており、処理時間が長くなってしまいます。

>この問題を解決するために最適なソリューション設定を選択してください。 （2つ選択してください。）

*A: 両方の関数の同時実行制限を450にする,*
*最初の関数の同時実行制限を減らす*

***
note:

>初めてLambda関数を呼び出すと、AWS Lambda により関数のインスタンスが作成され、イベントを処理するためのハンドラーメソッドが実行されます。関数はレスポンスを返すときに、アクティブなまま待機した上で追加のイベントを処理します。最初のイベントの処理中に関数を再度呼び出すと、Lambda は別のインスタンスを初期化し、関数は 2 つのイベントを同時に処理します。関数の同時実行数は、複数のリクエストを同時に処理するインスタンスの数を指します。最初のトラフィックバーストの場合、リージョンでの関数の累積同時実行数は最初のレベル（500 から 3000 の間）に達する可能性があり、これはリージョンによって異なります。   

>同時実行数のバーストの制限
>3000 – 米国西部 (オレゴン)、米国東部（バージニア北部）、欧州 (アイルランド)
>1000 – アジアパシフィック (東京)、欧州 (フランクフルト)
>500 – その他のリージョン 

>東京リージョンでは、1000の同時実行制限が課せられています。アカウントの同時実行制限が1000で、10の機能がある場合、1つの機能の制限を200に、別の機能の制限を100に指定できます。残りの700は他の8つの機能で共有されます。AWS Lambdaは、予約されていない同時実行プールを最低100の同時実行で保持する必要があり、アカウントの合計制限が1000である場合、900を個々の機能に割り当てることに制限されます。
したがって、このシナリオでの正しいソリューションは次のとおりです。両方の関数の同時実行制限を450に設定することで、900以内の同時実行数に制限することです。オプション１が正解となります。 

>このシナリオでは、同時実行制限内で最初のLambda関数に同時実行数が偏って実行されている可能性が高いです。よって、最初の関数の同時実行制限を減らすことで、2つ目のLambda関数での同時実行数を増加させることも解決策となります。したがって、オプション３も正解となります。 

* LambdaのMaxの実行数は-100！100は余らせる必要あり

## 質問7:不正解
>あなたの会社はEC2インスタンスのAuto ScalingグループとALBで構成されるWebアプリケーションを利用しています。同じWebアプリケーションバージョンが複数のEC2インスタンスにホストされ、Auto Scalingグループが設定されています。 アプリケーションはSTSを使用して資格情報を取得しゲストユーザーへのアクセスを許可します。しかしながら、このゲストユーザーは途中でアクセスできなくなってしまいました。

>この問題の最も可能性の高い原因は何でしょうか？

*A: 資格条件が1時間後に有効期限が切れてしまうため*

***
note:

* STS = Security Token Service
* 一時的なアクセス権限は900秒（15分）から最大3,600秒（1時間）の範囲で有効期限が設定可能
* デフォルトでは最大の1時間に設定される

## 質問8:不正解
>企業はAWS上でCodeシリーズを利用してCI / CD開発環境を整備して、アプリケーションを構築しています。あなたは開発者として、CodeDeployを使用してアプリケーションをAWSのさまざまなコンピューティングプラットフォームにインプレースデプロイする対応を行っています。

>CodeDeployのインプレースデプロイとして正しい内容を選択してください。（2つ選択してください。）

*A: EC2はインプレーすデプロイタイプを使用できる,*
*オンプレミスアプリケーションはインプレースデプロイタイプを使用できる*

***
note:
* インプレースデプロイは停止時間ありでEC2とオンプレミスのみに対応しており、ECSやLambda関数には適用されない

>■インプレイスデプロイ
デプロイグループの各インスタンス上のアプリケーションが停止され、最新のアプリケーションリビジョンがインストールされて、新バージョンのアプリケーションが開始され検証されます。ロードバランサーを使用すれば、各インスタンスがデプロイ中に登録解除され、デプロイ完了後にサービスに復元されるようにすることができます。インプレイスデプロイは、EC2/オンプレミス コンピューティングプラットフォーム使用するデプロイでのみ使用できます。 

>■Blue/Green デプロイ
デプロイの動作は使用するコンピューティングプラットフォームによって異なります。  EC2/オンプレミス コンピューティングプラットフォームの Blue/Greenデプロイではデプロイグループのインスタンス (元の環境) がインスタンスの別のセット (置き換え先環境) に置き換えられます。

## 質問9:不正解
>B社はAWSのサーバレスアーキテクチャを社内で新規採用することになり、その知識獲得を開発部門で実施しているところです。まずはCloudFormationを使用して、単純なnode.jsコードのLambda関数をデプロイすることを計画しています。

>この要件を満たすことができる、最適なデプロイ方法を選択してください。

*A: CloudFormationテンプレートのAWS::Lambda::FunctionリソースのZipFileパラメータに関数ソースをインラインで含める*

***
note:

* AWS::Lambda::FunctionリソースのZipFileパラメータにインラインで埋め込めるのは、Node.jsとPython

>デプロイパッケージは、関数コードと依存関係を含む ZIP アーカイブです。Lambda API を使用して関数を管理する場合や、AWS SDK 以外のライブラリや依存関係を含める必要がある場合は、デプロイパッケージを作成する必要があります。パッケージを Lambda に直接アップロードするか、Amazon S3 バケットを使用して Lambda にアップロードすることができます。

>CloudFormationテンプレートを使用している場合、Lambda関数を作成するAWS :: Lambda :: Functionリソースを設定できます。 AWS :: Lambda :: Functionリソースの下で、Lambda関数のデプロイパッケージを含むCodeプロパティを使用できます。Node.jsおよびPython関数の場合、テンプレートで関数コードをインラインで指定できます。 Amazon S3のデプロイメントパッケージへの変更は、スタックの更新中に自動的に検出されません。機能コードを更新するには、テンプレートのオブジェクトキーまたはバージョンを変更します。したがって、CloudFormationテンプレートのAWS :: Lambda :: FunctionリソースのZipFileパラメーターに関数ソースをインラインで含めることが正しい内容です。 

## 質問10:不正解
>B社ではAWSを使用したハイブリッドクラウドアーキテクチャを採用しました。一部インフラやアプリケーションをAWSへと移行することが必要となっており、その一環としてCross-Origin Resource Sharing (CORS)を利用してAmazon S3を使用した静的ウェブサイトのセットアップを実施する必要があります。

>このシナリオにおける適切なS3の設定方法を選択してください。（2つ選択してください。）

*A: 静的ウェブサイトとしているドメインからS3バケット内のオブジェクトを表示、追加、削除、更新することを許可する,*
*XMLドキュメントによりCORS設定を作成する* 

***
note:

* Cross-Origin Resource Sharing (CORS) は、特定のドメインにロードされたクライアントからドメイン内の別のリソースと通信する方法
* 例えばフロントのjsはコンパイルして、S3に置いてそこからEC2などのサーバーにアクセスするなどができる

>Cross-Origin Resource Sharing (CORS) は、特定のドメインにロードされたクライアントウェブアプリケーションが異なるドメイン内のリソースと通信する方法を定義します。CORS のサポートにより、Amazon S3 を使用して機能豊富なクライアント側ウェブアプリケーションを構築し、Amazon S3 リソースに対するクロスオリジンアクセスを選択的に許可することができるようになりました。

>クロスオリジンリクエストを許可するようにバケットを設定するには、CORS 設定を作成します。これは、バケットへのアクセスを許可するオリジン、各オリジンをサポートするオペレーション (HTTP メソッド)、およびその他のオペレーション固有の情報を識別するルールを含む XML ドキュメントです。 設定には、最大 100 のルールを追加できます。XML ドキュメントを cors サブリソースとしてバケット にプログラムで追加するか、または Amazon S3 コンソールを使用して追加します。  

>ルールとして、http://www.example1.com オリジンからのクロスオリジン PUT、POST、および DELETE リクエストを許可します。このルールは、Access-Control-Request-Headers ヘッダーによって、プリフライト OPTIONS リクエスト内のすべてのヘッダーも許可します。プリフライト OPTIONS リクエストへのレスポンスとして、Amazon S3 はリクエストされたヘッダーを返します。ユーザーがドメインからS3バケット内のオブジェクトを表示、追加、削除、または更新を許可することで　ブラウザーはプリフライトOPTIONSリクエストのAmazon S3レスポンスを1時間キャッシュすることができます。

## 質問11:不正解
>開発部門では開発、テスト、および本番環境のデプロイプロセスを自動化するため、CloudFormationテンプレートを使用することになりました。テンプレートは定期的に更新され、最新のAMI IDを利用できるように展開プロセスを自動化する対応が必要です。

>新しいAMIがリリースされた際に最新AMIにアップデートする最適な方法を選択してください。（2つ選択してください。）

*A: Systems Managerパラメータストアを利用してCloudFormationテンプレートに最新のAMI IDを取得する,*
*AMIを更新する場合は、CloudFormationスタックを更新する*

***
note:

* パラメータストアに変更の可能性のあるリソース情報を持っておき、それをCloudFormationから参照するようにすればそのパラメータストアの内容を変えるだけで全てのそのリソース情報を一括で変えることができる

* パラメータを変更したあとはCloudFormationを再度実行することで、値が変わってリソースが作成される

## 質問12:不正解
>A社はAWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成した新しいサーバーレスアーキテクチャを構築しています。Lambda関数は非プロキシLambda統合によってAPI Gatewayと統合しています。このアプリケーションを実行するためには、Lambda関数のコンシューマーがデータを取得するために要求にdataTypeという名前のクエリ文字列パラメーターを含める必要があります。

>この要件を満たすために、最適な実装方式を選択してください。

*A: クエリ文字列を含めたリソースのメソッドリクエストを構成する*

***
note:

* 統合リクエストはAPIGatewayからLambdaへのリクエスト
* クエリ文字列を受け付けるのは最初の入り口である、メソッドリクエストにGETのパラメータ/?dataType=77のように設定する

## 質問13
>開発者はEC2インスタンスとDynamoDBを連携させたモバイルゲームアプリケーションを構築しており、パーティションキーがGameNameでソートキーがSubjectとして設定したDynamoDBテーブルを構築し、現在はDynamoDBの新規テーブル設定を行っているところです。このテーブルデータが投稿後の期日に応じてデータ抽出する設定が必要です。

>この要件を満たすために、最適な実装方式を選択してください。

*A: ローカルセカンダリインデックスを作成し、クエリ操作を使用してLastPostDateTime属性を並べ替えキーとして使用する。

***
note:

* 参考↓
>https://www.wakuwakubank.com/posts/639-aws-dynamodb-introduction/

## 質問14:不正解
>B社ではS3ストレージからhttp://realquality.s3-website-ap-northeast-1.amazonaws.comエンドポイントを利用した静的WEBサイトを公開しました。このWEBサイトにJavaScriptを使用して、外部サイトとの連携を行います。GETリクエストはS3 APIエンドポイントを介して同じバケットに送信されますが、HTTP要求をブロックしてエラーが発生しています。

>この問題に対応するための、最適な対応方法を選択してください。

*A: バケット内のクロスオリジンリソース共有(CORS)構成を有効にする*

***
note:

>オリジン間リソース共有Cross-Origin Resource Sharing (CORS) はあるオリジンで動作しているウェブアプリケーションに、異なるオリジンにある選択されたリソースへのアクセス権を与えるようブラウザーに指示するための仕組みです。ブラウザーが HTTP の OPTIONS リクエストメソッドを用いて、あらかじめリクエストの「プリフライト」 (サーバーから対応するメソッドの一覧を収集すること) を行い、サーバーの「認可」のもとに実際のリクエストの送信することができます。

>したがって、バケット内のクロスオリジンリソース共有（CORS）構成を有効にするだけで、シナリオの問題を解決できます。

## 質問17:不正解
>ある企業ではバックエンドシステムとして10TB相当のスキャンファイルを保存しています。あなたはエンジニアとして、このスキャンしたファイルを検索する仕組みをAWS上に構築するように依頼されました。

>この要件を満たすための最適なサービスの使い方を選択してください

*A: S3標準ストレージを利用して、スキャンファイルを保存し、AmazonCloudSearchw利用してクエリ処理アプリケーションを構築して、ElasticBeanstalkによりマルチAZにホストするn*

***
note:

* S3 Selectは簡易なS3データの抽出検索に利用されるサービスであり、性能的に検索エンジンとしては最適ではない 別途検索のサービスを使う

>Amazon CloudSearchかElasticSearchを利用します。Amazon CloudSearchは AWS クラウドにおけるマネージド型サービスであり、ウェブサイトまたはアプリケーション向けの検索ソリューションを容易かつコスト効率良く設定、管理、スケールできます。

>また、Elastic Beanstalkによりワーカー環境を展開することができるため、これによりマルチAZにホストするように展開することができます。

## 質問19:不正解
>B社はAWS Lambdaを使用してDynamoDBに新しく挿入されたアイテムに対して追加処理を実施するアプリケーションを開発しています。そのためにはDynamoDBストリームを使用して、テーブル内の新しいアイテムをLambda関数に自動的に送信して処理する必要があります。

>DynamoDBをLambda関数に統合する方法を選択してください。 （2つ選択してください。）

*A: AWSLambdaDynamoDBExecutionRole管理ポリシーをLambda関数の実行ロールとして設定する,*
*ストリームからLambda関数にレコードを送信するようLambdaに指示するイベントソースマッピングを作成する*

***
note:

* DynamoDBストリームを使用すると、DynamoDBテーブルが更新されるたびにLambda関数をトリガーして追加の作業を実行できる

* イベントソースマッピングを作成して、ストリームからLambda関数にレコードを送信するようにLambdaに指示する

## 質問20:不正解
>開発者はAPI GatewayとLambda関数とDynamoDBを連携させたモバイルアプリケーションを開発しています。 あなたはエンジニアとして、着信リクエストを統合要求にマッピングする方法と、結果の統合応答データをメソッド応答にマッピングする方法を指定する方式で、API GatewayとLambda関数を統合する設定を行っています。

>この要件を満たすことができる、最適な実装方式を選択してください。

*A: Lambdaカスタム統合*

***
note:

* Lambdaカスタム統合はLambda非プロキシ統合のこと
* Lambdaプロキシ統合はリクエストとレスポンス両方設定
* Lambda非プロキシ統合はリクエストとレスポンスを統合して設定しないため、今回はリクエストを受けてLambdaで処理しその結果を別のメソッドに飛ばしたいためこちらが正しい

## 質問21:不正解
>C社はEC2インスタンスとDynamoDBを連携させた大規模なWEBアプリケーションを開発しています。このアプリケーションではX-Rayを利用したトレースが必須となっており、あなたはエンジニアとして最適なX-Rayの設定を実施するように依頼されました。

>この要件を満たすために、最適なX-Rayの設定方式を選択してください。（2つ選択してください。）

*A: メタデータにセグメントに保存する追加のカスタムデータを設定する,*
*AWS SDK呼び出しの場合は名前空間サブセグメントフィールドをawsに設定し、他のダウンストリーム呼び出しの場合はリモートを設定する*

***
note:

>セグメントドキュメントは、セグメントに関する情報を X-Ray に伝えます。セグメントドキュメントは最大で 64 kB とし、サブセグメントを含むセグメント全体、リクエストが進行中であることを示すセグメントのフラグメント、または別個に送信される単一のサブセグメントを含むことができます。セグメントドキュメントは、PutTraceSegments API を使用して直接 X-Ray に送信できます。

>X-Ray はセグメントドキュメントをコンパイルおよび処理し、それぞれ GetTraceSummaries API と BatchGetTraces API を使用してアクセスできる、クエリ可能なトレースサマリとトレース全体を生成します。このサービスは、X-Ray に送信するセグメントとサブセグメントに加えて、サブセグメントの情報を使用して推測セグメントを生成し、トレース全体に追加します。推定セグメントは、サービスマップのダウンストリームサービスとリソースを表します。セグメントフィールドのサブセットは、フィルター式で使用するためにX-Rayによってインデックスが付けられます。

>たとえば、セグメントのユーザーフィールドを一意の識別子に設定すると、X-RayコンソールまたはGetTraceSummaries APIを使用して、特定のユーザーに関連付けられたセグメントを検索できます。設定においては、AWS SDK呼び出しに対しては名前空間サブセグメントフィールドをawsに設定します。また、他のダウンストリーム呼び出しの場合はリモートを設定し、メタデータにセグメントに保存する追加のカスタムデータを設定します。   

## 質問22:不正解
>あなたは開発者として、AWS上でアプリケーションを開発しています。このアプリケーションはLinux EC2インスタンスにAuto Scalingグループが設定されています。アプリケーションの不具合の解析にAWS X-Rayを利用することが必要ですが、そのためにはLinux EC2インスタンスに対してAWS X-Rayにトレースデータを送信できるように設定が必要です。

>最適なX-Rayの実装方法を選択してください。

*A: ユーザーデータスクリプトを使用してX-Rayデーモンをインストールする。*

***
note:

* X-Rayにデーモンから送信するためにX-Ray SDKにユーザーデーターのスクリプトを実行しアクセス権限を与えて送信できるようにする

>AWS X-Ray SDKは、トレースデータをAWS X-Rayに直接送信しません。アプリケーションがリクエストを処理するたびにサービスを呼び出さないように、SDKはトレースデータをデーモンに送信します。デーモンは、複数のリクエストのセグメントを収集し、バッチでアップロードします。スクリプトを使用して、アプリケーションと一緒にデーモンを実行します。

>Amazon EC2 上の次のオペレーティングシステムで X-Ray デーモンを実行できます。 

```
• Amazon Linux
• Ubuntu
• Windows Server (2012 R2 以降)
```

>インスタンスプロファイルを使用して、トレースデータを X-Ray にアップロードするアクセス権限をデーモンに付与します。インスタンスを起動する際に、ユーザーデータのスクリプトを使用して自動的にデーモンを実行します  

## 質問25:不正解
>A社はAWS Lambda、API Gateway、およびS3で構成した新しいサーバーレスアーキテクチャを利用しています。最近デプロイしたLambda関数は処理の一部として、環境に応じて変化する外部APIサービスを利用しています。Lambda関数は外部サービスに対して異なるエンドポイントを使用して、処理を適切に完了する必要があります。

>この要件を満たすLambdaの実装方法を選択してください。

*A: Lambda関数の環境変数を利用する*

***
note:

>Lambda関数の環境変数を利用することで、複数の環境で利用できるコードを作成して、簡単に再利用するように実行時に設定値として受け入れられる環境変数として設定することができます。設定値はコードの環境をカスタマイズするためのテーブル名、デバイス名、ファイルパスなどです。たとえば、多くのプロジェクトは開発環境、テスト環境、本稼働環境ごとに設定が異なります。Lambda 関数に環境変数を指定することで、コードを変更または再デプロイすることなく設定の変更が可能になり、これまで以上にサーバーレスアプリケーション開発を効率的に行うことができます。

>環境変数を使用すると、ライブラリがファイルをインストールするディレクトリ、出力の保存場所、接続およびログ設定の保存要否などを知ることができます。これらの設定をアプリケーションロジックから分離することにより、異なる設定に基づいて関数の動作を変更する必要がある場合に関数コードを更新する必要がなくなります。

## 質問28:不正解
>A社ではアプリケーション開発においてAWSのcodeシリーズと呼ばれるAWS CodeCommitとAWS CodeDeployなどを利用して開発・テスト・デプロイまでのパイプラインを設置したCI/CDを整備しています。送信中および保存中にソースコードを暗号化するためにgit pushコマンドなどのアクティビティ通信を暗号化する設定が必要です。

>この要件を満たす確認方法を選択してください

*A: リポジトリは保管時に自動的に暗号化される*

***
note:

>AWS CodeCommitリポジトリのデータは、転送中および保管中に自動的に暗号化されます。 データがAWS CodeCommitリポジトリにプッシュされると、AWS CodeCommitは、受信したデータがリポジトリに保存される際にデータの暗号化を実行します。 

## 質問30:不正解
>あなたの会社は 東京リージョンの複数AZに何十台ものEC2インスタンスを展開しており、ELBとAutoScalingグループによる冗長構成をとっています。スクリプトを使用してすべてのEC2インスタンスのシステムメモリメトリクスをスケジュール通りに定期的に収集する設定が必要です。

>データの収集のためのソリューション方式を選択してください。（2つ選択してください。）

*A: CloudWatchエージェントを利用して、EC2インスタンスのシステムメモリメトリクスを収集する,*
*EC2インスタンスのシステムメモリメトリクスを収集するcronジョブを使用する*

***
note:

>EC2インスタンスのシステムメモリメトリクスを収集するcronジョブを使用します。cronとは、UNIX系OSで標準的に利用される常駐プログラムであり、利用者の設定したスケジュールに従って指定されたプログラムを定期的に起動してくれるものです。CloudWatchに報告されるメトリクスのcronスケジュールを設定し、定期的にメモリ使用率をCloudWatchに報告できます。 

## 質問32:不正解
>A社が開発中の業務アプリケーションはELBとAuto Scalingグループを設定したEC2インスタンスに、AWS KMSを使用したサーバーサイド暗号化が設定されたS3バケットで構成されています。CloudWatchによるモニタリングを設定する必要がありますが、要件として、CloudWatchアラームは最新の3つの連続した期間の3つの全てのデータポイントが、閾値を超えた場合にのみトリガーされることが必要です。

>指定された閾値に基づいてWebサイトを監視する最適な設定を選択してください。

*A: 評価期間とデータポイントの両方に対して3を設定する*

***
note:

* CloudWatch アラームを作成する際は、CloudWatch がアラームの状態を変更するタイミングを評価できるように 3 つの設定を指定。

```
■期間
アラームの各データポイントを作成するためにメトリクスや式を評価する期間です。
これは秒単位で表されます。
期間として 1 分を選択した場合、1 分ごとに 1 つのデータポイントが存在します。 

■評価期間
アラームの状態を決定するまでに要する直近の期間 (データポイント) の数です。


■Datapoints to Alarm (アラームを発生させるデータポイント数)] 
アラームが ALARM 状態に移るためにしきい値を超える必要がある評価期間内のデータポイントの数です。
```

* 期間はCloudWatchで取得する間隔のこと
* 評価期間はアラームを発行するか決める直近の期間のこと
* 評価期間が3、データポイントも3でアラームになる

## 質問34:不正解
>B社はAWSを利用したアプリケーション開発を行っています。このアプリケーションはALBを設定した複数のEC2インスタンスで構成されており、EBSボリュームに保存されている暗号化されたファイルをEC2インスタンスで処理しています。あなたはエンジニアとして、アプリケーションがファイル処理を進める前にファイルをローカルで復号化する設定を行っています。

>安全にデータを復号化することが可能となる最適な方法を選択してください。 （2つ選択してください。）

*A: Encrypt操作を使用してプレーンテキストデータキーを暗号化する,*
*プレーンテキストデータキーを使用してローカルでデータを復号し、メモリからプレーンテキストデータキーを消去する*

***
note:

>AWS KMS は AWS Encryption SDK と統合されており、KMS で保護されたデータの暗号化キーを使用してアプリケーション内でローカルに暗号化および復号化することができます。簡単な API を使用して、実行場所に関わらずお客様自身のアプリケーションに暗号化とキー管理を組み込むこともできます。 データをローカルで復号化するには以下の手順を実施します。 
```
１．Encrypt操作を使用して暗号化されたデータキーを作成する。
    操作は、データキーのプレーンテキストコピーを返します。

２．平文データキーを使用してローカルでデータを復号化し、
    メモリから平文データキーを消去します。  
```

・ローカルというのはEC2上のことでEBSから復号して処理したい
・そのためにキーの平文を暗号化し、そのコピーを取得
・取得したコピーで暗号を復号し、そのコピーの平文をメモリから消去するという流れ

## 質問36:不正解
>あなたはアプリ開発・導入担当として、Elastic Beanstalkを利用してWEBアプリケーションをデプロイしています。このアプリケーションはデータベースにRDSを利用してSSE-Cによる暗号化を使用したS3バケットをストレージとして利用しています。この設定では、Amazon S3は提供された暗号化キーを保存せず、将来のリクエストを検証するために、ランダムにソルト（Salt）されたハッシュベースのメッセージ認証コード（HMAC）値を保存します。

>これらのアーキテクチャを実装する際に必要となるポイントを選択してください。

*A: 暗号化キーを失うと、復号化できないためオブジェクトも失われる*

***
note:

* S3には暗号に使った暗号化キーをソルトした値で保存しているため、それをなくしたら復号できないよってこと

## 質問39:不正解
>B社は医療情報システムを開発しているヘルステック企業です。現在、AWS上で医療情報処理システムを運用しており、MRIやCATスキャンなど、患者の高解像度画像記録を管理しています。 データは通常はS3 Standardクラスのストレージに保存されますが、1年前のデータは暗号化されてからGlacierにアーカイブされます。これらの医療データは緊急時に必要なデータだけを5時間以内に入手できるようにする必要があります。

>これらの要件を満たすことができる検索方法を選択してください。

*A: Glasierの標準取り出しを選択して、S3 Glasie Selectを使用してデータを検索する*

***
note:

* Amazon S3 Glacier Select では、Amazon S3 Glacier に保存されているデータを直接検索することができ、アーカイブ全体を取得する必要がない

>[迅速] 取り出しを使用してリクエストされたアーカイブは、通常 1～5 分以内に使用可能となり、不定期に発生する、アーカイブのサブセットに対する緊急リクエストの際にデータに迅速にアクセスできます。
>[標準] 取り出しの場合、アーカイブは通常、3～5 時間以内に使用可能になります。
>[大容量] 取り出しを使用すれば、ペタバイト規模であっても、0.0025 USD/GB で、データの重要な部分にコスト効率よくアクセスできます。 

## 質問40:不正解
>B社はAWSでサーバーレスアプリケーションを構築しています。 アプリケーションは、AWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成されてます。API Gateway Lambda オーサライザーを使用して、WebアプリケーションへのAPIリクエストを安全に認証しています。認証プロセスは、API呼び出し元からヘッダーおよびクエリ文字列パラメーターを受け入れるカスタム承認スキームを使用して実装する必要があります。

>この要件を満たすために、最適な実装方式を選択してください。

*A: リクエストパラメータベースのLambdaオーソライザーを使用する*

***
note:

* ヘッダーとクエリ文字列パラメータを受け入れる必要があるため、リクエストパラメータのオーソライザーを使用する必要あり

>Lambda オーソライザー はLambda 関数を使用して API へのアクセスを制御する API Gateway の機能です。 Lambda オーソライザーには 次の2 種類があります。 

>■トークンベース の Lambda オーソライザー  (TOKEN オーソライザーとも呼ばれる) は、JSON ウェブトークン (JWT) や OAuth トークンなどのベアラートークンで発信者 ID を受け取ります。 
■リクエストパラメータベースの Lambda オーソライザー  (REQUEST オーソライザーとも呼ばれる) は、ヘッダー、クエリ文字列パラメータ、stageVariables、および $context 変数の組み合わせで、発信者 ID を受け取ります。 

## 質問41:不正解
>ある会社はデータアクセスにDynamoDBを使用してWebアプリケーションを開発しています。アプリケーションはスキャン操作を利用してDynamoDBテーブルからアイテムを取得する設定が必要です。 インデックスを利用しないで、できるだけ早くDynamoDBからコンテンツを取得する対応が必要です。

>パフォーマンスを改善するために最適なソリューションを選択してください。

*A: 並列スキャンを使用する*

***
note:

>DynamoDBテーブルからデータをより迅速に取得できるようにするために、テーブルのReadスループットの設定値を上げる方法以外にも、並列スキャンを利用することができます。並列スキャンは、その名の通り、1つのテーブルに対するスキャンリクエストを並列に行うための仕組みで、テーブルの操作領域を複数のセグメントに分割し、各セグメントに並行してスキャンリクエストを実施できます。

## 質問44:不正解
>アプリ開発企業はAPI Gateway、およびDynamoDBを単一のスタックで構成したリアルタイム双方向通信アプリケーションを構築しています。あなたはエンジニアとして、APIの設定を行っているところです。

>設定するべきAPI方式を選択してください。

*A: WebSocket APIを使用する*

***
note:

* API Gatewayで設定できるAPIは３種類

>■HTTP API
API プロキシ機能を必要とする高性能 RESTful API を API 管理機能なしで構築できます。HTTP API はサーバーレスアプリケーションと HTTP バックエンド向けに最適化されており、REST API と比較して最大 70％ のコスト削減を実現します。 

>■REST API
単一のソリューションで API プロキシ機能と管理機能を同時に必要とするワークロードに使用します。API 管理機能には、API キー、API の公開、API の収益化による使用量クォータの追跡と適用が含まれます。 

>■WebSocket API
チャットアプリケーション、ストリーミングダッシュボードといったリアルタイム双方向通信アプリケーションを構築できます。API Gateway は、バックエンドサービスとクライアント間のメッセージ転送を処理するために永続的な接続を維持します。

* このなかでリアルタイム双方向通信できるのはWebSocket API

## 質問45:不正解
>開発チームはサーバーレスアプリケーションの構築を完了し、デプロイの準備を行っています。Lambdaコードを圧縮し、Amazon S3にアップロードし、デプロイ用のパッケージテンプレートファイルを作成します。あなたはソリューションアーキテキトとして、マネージャーからこのデプロイプロセスを自動化する設定を依頼されました。

>このデプロイプロセスを自動化する際に利用するコマンドを選択してください。

*A: sam deployコマンドを実行する*

***
note:

* SAM deployでlambdaのデプロイを自動化できる

>AWS サーバーレスアプリケーションモデル (SAM） は、サーバーレスアプリケーション構築用のオープンソースフレームワークです。デプロイ中、SAM が SAM 構文を AWS CloudFormation 構文に変換および拡張することで、サーバーレスアプリケーションの構築を高速化することができます。AWS SAM CLIコマンドを使用して、アプリケーションをデプロイできます。 AWS SAMと統合する他のAWSサービスを使用して、デプロイを自動化することもできます。
サーバーレスアプリケーションをローカルで開発およびテストした後、sam deployコマンドを実行することでアプリケーションをデプロイできます

## 質問48:不正解
>あなたはサーバーベースのアプリケーションをLambdaベースのアプリケーションへと移行する対応を行っています。したがって、実際にLambdaアプリケーションとして移行が可能かどうかを検証する必要があります。その際には、Lambdaの関数コードをコーディングする際に、ベストプラクティスに準拠することが要件となっています。

>Lambda関数の関数コードにおけるベストプラクティスを選択してください。（2つ選択してください。）

*A: Lambdaハンドラーをコアロジックから分離する,*
*再帰的なコードの使用を避ける*

***
note:

* Lambdaのベストプラクティスは以下の通り

>・Lambda ハンドラーをコアロジックから分離します。 
・実行コンテキストの再利用を活用して関数のパフォーマンスを向上させます。
・環境変数を使用して、オペレーショナルパラメータを関数に渡します。 
・関数のデプロイパッケージの依存関係を制御します。 
・デプロイパッケージのサイズをランタイムに必要な最小限のサイズにします。
・Java で記述されたデプロイパッケージを Lambda で解凍する所要時間を短縮します。
・依存関係の複雑さを最小限に抑えます。
・Lambda 関数内で、任意の条件が満たされるまで、その関数自身を自動的に呼び出すような再帰的なコードを使用しないでください。

## 質問52:不正解
>B社は漫画アプリを運用している大手出版社です。人気漫画のモバイル人気投票アプリをリリースして、連載中の漫画の人気投票が行えるサービスを準備しているところです。このモバイルアプリケーションは500万ユーザーが見込まれており、システム内で何百万ものメッセージを処理するパフォーマンが必要不可欠です。 処理負荷への対応として最大198 KBのメッセージを受信することができるSQSキューを設定しています。 

>これらのメッセージをSQSに送信することは可能でしょうか？

*A: SQSの最大メッセージサイズは256KBであり、既存のサイズで実装可能である*

***
note:

* SQSの最大メッセージサイズは256KB！最小は1バイト（１文字）

## 質問53:不正解
>あなたはエンジニアとして、新しいLambda関数を利用したアプリケーションを構築しています。このLambda関数はAWS CLIから実行するためにシェルスクリプトを追加しています。しかしながら、このシェルスクリプトを実行してLambda関数を実行したところ、InvalidParameterValueExceptionが発生してしまいました。

>この問題の最も可能性の高い要因を選択してください。

*A: AWS Lambdaが引き受けることができないCreateFunction APIでIAMロールを提供している*

***
note:

* Lambdaを実行するにはその実行ロールと展開パッケージが必要

>リクエスト内のパラメーターの1つが無効な場合、InvalidParameterValueExceptionが返されます。たとえば、AWS Lambdaが引き受けることができないCreateFunction APIでIAMロールを提供した場合などにInvalidParameterValueExceptionが返されることになります。 

## 質問55:不正解
>A社ではLambda関数を使用してAIベースのトラフィック監視アプリケーションを構築しています。開発者はLambda関数のセットアップコードを実行する方法や、LambdaランタイムAPIから呼び出しイベントを読み取る方法など、特定の変更を行う必要があります。

>この要件を満たす最適なLambda関数の実装方式を選択してください。

*A: カスタムランタイムを利用してLambda関数を実装する*

***
note:

* Lambdaで複数の言語を使用してデプロイなどするためにはカスタムランタイムを利用する
* 通常のLambdaより特定の変更を行うものはカスタムランタイム

## 質問56:不正解
>あなたはAWS専門のエンジニアとして、IoTデータをリアルタイムにキャプチャしてAmazon Kinesis Data Streamsに送信するモバイルアプリを構築しています。KinesisプロデューサーはPutRecord APIを使用して、ストリームにデータを送信します。ただし、処理中にプロデューサーが断続的に再起動され、同じデータがストリームに2回送信される場合があり、データストリーム内のエントリが誤って重複する可能性があります。

>この問題を解決するに最適な実装方式を選択してください。

*A: レコード内に主キーを埋め込み、後で処理するときに削除する*

***
note:

* Amazon Kinesis Data Streamsを利用してレコードが複数回配信される原因は、プロデューサーの再試行とコンシューマーの再試行が実施されること

* プロデューサーはレコードがKinesis Data Streamsに配信されたかどうかを確認できないため、ネットワーク関連のタイムアウトが発生するなどして処理が滞った場合に、再試行を実施してレコードを再送信することになり重複が起きる

* 重複レコードを許さない厳密な記録管理が必要なアプリケーションは、レコード内に主キーを埋め込み、後で処理するときに重複を削除する

* Amazon Kinesis Data Streamsに重複削除IDを利用するといった設定はない！これはSQS

## 質問57:不正解
>B社ではアプリケーション開発においてAWS CodeCommitとAWS CodeDeployなどを利用して開発・テスト・デプロイまでのパイプラインを設置したCI/CDを整備しています。プロジェクトにアクセスするために開発チームに所属する複数の開発メンバーに対してIAMユーザーの権限が付与することが必要です。したがって、開発者にCodeCommitへのアクセスを許可して、ローカルコンピューター上のコードリポジトリを完全に利用できるようにする必要があります。

>開発者にCodeCommitへのアクセスを許可するには、最適な設定方法を選択してください。 （2つ選択してください。）

*A: 開発者にCodeCommitアクセスを適切に付与するには、HTTPS Git認証情報を生成する,*
*新しいSSHキーを生成し、公開SSHキーを開発者の各IAMユーザーに関連付ける*

***
note:

* Amazon Cognitoユーザープールによるアクセス認証を実施して、CodeCommitを認証することはできない

* Cognitoで認証できるのはAPIやLambdaなど

## 質問58:不正解
>あなたはAWS専門のエンジニアとして、車両データをキャプチャしてAmazon Kinesis Data Streamsに送信するモバイルアプリを構築しています。このアプリケーションでは、AWS Lambda関数を使用して、50個のアクティブなシャードを持つAmazon Kinesis Data Streamsストリームのレコードを処理しています。 Lambda関数はデータの処理に平均10秒かかり、ストリームは1秒あたり50個の新しいアイテムを受信しています。

>同時に実行されるLambda関数の最大実行数はどれでしょうか？

*A: 最大50のLambda関数呼び出しが同時に実行される*

***
note:

* KinesisまたはDynamoDBストリームを処理するLambda関数の場合、シャード数は同時実行の単位

## 質問59:不正解
>B金融機関はAmazon ECSを利用したDockerにより、高トラフィックのオンライン株式取引アプリケーションを開発しています。このアプリケーションは、数千人の投資家が日中の株式取引にアクセスするため、高性能なパフォーマンスが不可欠となっています。 サービスの中断を避けるため、クラスターの各タスクは複数AZに均等に配置する必要があります。

>次のうち、タスク定義で使用するべき最適な配置戦略の構成はどれですか？

*A: タスク配置戦略はspreadを選択しfield値にattribute:ecs.availability-zoneを設定する*

***
note:

* binpackは最小、ランダムはランダム、spreadは負荷分散
* スプレッド戦略を使用する場合、フィールドパラメータも指定する必要があります。そして、構成としては、「attribute：ecs.availability-zone」と設定することが必要

## 質問60:不正解
>A社はEC2インスタンスとEFSで構成されたアプリケーションを開発しています。あなたは、EC2インスタンスにEFSマウントヘルパーをインストールし、データ転送を暗号化するように依頼されました。

>EFSのマウントに向けた適切なマウントヘルパーの設定方法は選択してください。（2つ選択してください。）

*A: コンソールまたは実行コードによって、EFSファイルシステムIDをEFS APIから取得する*
*マウントヘルパーユーティリティを利用した際に、暗号化オプションの-o tlsを追加する*

***
note:

>Amazon Elastic File Systemでは、Amazon EC2 で使用するためのシンプルでスケーラブルなファイルストレージを提供します。Amazon EFS を使用すると、ストレージ容量は弾力的で、ファイルの追加や削除に応じて自動的に拡張および縮小されるため、アプリケーションは必要なときに必要なストレージを確保できます。マウントヘルパーユーティリティであるamazon-efs-utils パッケージは、Amazon EFS ツールのオープンソースのコレクションです。amazon-efs-utils は追加コストなしで使用でき、 https://github.com/aws/efs-utilsで、GitHub からこれらのツールをダウンロードできます。amazon-efs-utils パッケージは、Amazon Linux パッケージリポジトリで利用でき、他の Linux ディストリビューションのパッケージをビルドおよびインストールできます。

* コンソールまたは実行コードによって、EFSファイルシステムIDをEFS APIから取得して、EC2インスタンスからのアクセスの際に設定することが求められます。EFSファイルシステムIDを利用してEC2 インスタンスを起動し、EFS ファイルシステムをマウント IDでマウントする

* マウントヘルパーユーティリティのamazon-efs-utils パッケージには、マウントヘルパーおよび Amazon EFS の転送時のデータ暗号化の実行を簡単にするツールが用意されています。マウントヘルパーユーティリティを利用した際に、暗号化オプション「-o tls」を追加することが可能   


## 質問61:不正解
>あなたはエンジニアとして、RubyベースのEC2インスタンスにホストされたECサイトの新規機能開発を担当しています。このECサイトでは顧客データベースとしてRDSを、セッションデータ管理やアクセス制御にDynamoDBを要所で利用しています。新規機能開発としてNode.jsベースで作成された画像検索機能が統合される予定です。AWS OpsWorksをデプロイツールとして使用して、アプリケーションの管理を簡素化し、デプロイサイクルを短縮することが要件となっています。

>新しいモジュールを統合するためのOpsWorksの設定を選択してください。

*A: 1つのOpsWorksスタックに2つのOpsWorksレイヤーと1つのカスタムrecipeを作成する*

***
note:

* OpsWorkはElasticBeanstalkより高度な設定ができるフルマネージドな展開サービス

>このシナリオでは、AWS OpsWorksを使用して、Ruby、node.jsで作成されたアプリケーションを管理することで、展開プロセスを合理化し、展開サイクルを短縮する必要があります。Rubyとnode.jsのリソース要件は異なるため、それらを異なるレイヤーにデプロイすることが必要となり、1つのスタック内に2つのレイヤーが必要です。また、これを記述するレシピは1つとなります。したがって、オプション４が正しいスタックです。スタックは1つで十分であり、個別の要件を処理するにはRuby用とnode.js用の2つのレイヤーが必要です。そして、全体としてカスタムレシピが1つ必要です。DynamoDBをデータレイヤーとして分離させる場合は、レイヤーを３つにすることも可能ですが、今回は選択肢に２つのレイヤーまでしかないため、アプリケーション全体を２つの言語にわけた２つのレイヤーを利用する構成でスタックを作成する構成を選択します。
  
>■スタック 
スタックは AWS OpsWorks スタックの中心となるコンポーネントです。これは基本的に AWS リソース (Amazon EC2 インスタンス、Amazon RDS データベースインスタンスなど) 用のコンテナです。目的が共通で、論理的に一括して管理されます。スタックにより、ユーザーはこれらのリソースをグループで管理することができます。また、インスタンスのオペレーティングシステムや AWS リージョンなどの一部のデフォルトの構成設定もスタックにより定義されます。ユーザーの直接操作から分離する必要のあるスタックコンポーネントがある場合、そのスタックを VPC 内で実行することもできます。    

>■レシピ 
レシピは、システムの設定を定義する Ruby アプリケーションです。これを使用して、パッケージのインストール、テンプレートからの設定ファイルの作成、シェルコマンドの実行、ファイルとディレクトリの作成などを行います。
   
>■レイヤー 
各スタックには、ロードバランサーや一連のアプリケーションサーバーなどのスタックコンポーネントを表す Layer が少なくとも 1 つ含まれます。AWS OpsWorks スタックレイヤーを使用する場合は、次の点に注意してください。スタックの各 Layer にはインスタンスが少なくとも 1 つ必要です。オプションで複数のインスタンスを指定することもできます。  ・スタックの各インスタンスは、登録されたインスタンスを除いて、少なくとも 1 つの Layer のメンバーとなっている必要があります。 ・SSH キーやホスト名などの基本的な設定を除き、インスタンスを直接設定することはできません。適切な Layer を作成および設定し、その Layer にインスタンスを追加する必要があります。

