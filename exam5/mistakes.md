## 質問1:不正解
>あなたはサーバレスアーキテクチャを構築しているA社のエンジニアです。現在はSQSキューを利用したマイクロサービスの開発を実施しています。SQSコンシューマーがメッセージ処理に設定以上の時間を要しており、重複したメッセージを受信するトラブルが発生しています。

>この問題を解決するために、最適な対応を選択してください。

*A: ChangeMessageVisibility APIをコンシューマレベルで使用する*

***
note:

* 可視性タイムアウトは事前にSQSのキューの処理の時間が分かっている場合に設定できる
* SQSキューを処理するコンシューマレベルでChangeMessageVisibility APIを設定することで、コンシューマの処理状況に合わせて動的に時間を延長できる

## 質問2:不正解
>ある会社ではモバイルデバイスとWebブラウザーからHTTPSトラフィックを受信する高可用性アプリケーションを開発しています。EC2インスタンスのWebサーバーとモバイルにアクセスするルーティング設定を現在の設定から、api.pintor.comおよびmobile.pintor.comに転送される設定することになりました。

>この要件を満たすことができる設定方法を選択してください。

*A: ホスト名とURLパスに基づいて転送ルールを設定する*

***
note:

* ホスト名とURLパスに基づいて転送ルールを設定することを、パスベースルーティングという
* マイクロサービスとかだとパスベースルーティングを使用して、トラフィックを複数のバックエンドサービスにルーティングできる

>ex)
>/txt/txt.html → alb1
>/img/img.html → alb2

>たとえば、一般的なリクエストを1つのターゲットグループにルーティングし、画像をレンダリングするリクエストを別のターゲットグループにルーティングできます。

## 質問3:不正解
>B社はモバイルデバイスとWebブラウザから利用するWEBアプリケーションを開発しています。 データベースとしてRDS MySQL5.7を利用しており、高速処理を実現するためにデータベースコールからデータ処理結果をキャッシュするマルチスレッドイベントベースのキャッシュストアを必要としています。 キャッシュレイヤー用に複数のコアを備えた大きなノードを実行する必要があります。

>この要件を満たすことができる適切なAWSサービスはどれですか？

*A: ElastiCache Memcached*

***
note:

* Redisはレプリケーションによるクラスターを組んで、冗長的な構成にできるがそのためレプリカ元のプライマリノードのみのシングルスレッドサーバーになってしまう（受け口が一個）

* Redisはキャッシュ版のマネージドに冗長を組んでくれるRDSみたいなイメージ

* Redisもスケールアウトできるが冗長化のために回されるため、複数のCPUの恩恵は得られない

* Memcachedはマルチスレッドだが、レプリケーションはなく各ノードで独立している

* Memcachedはスケールアウトによりマルチスレッドの数を増やすことできる

## 質問4:不正解

>A社ではAPI GatewayからLambdaを呼び出して、DynamoDBへとデータを記録・取得するサーバーレスアプリケーションを新しく作成されたAWSアカウントで東京リージョンにデプロイしました。これは2つの同一のLambda関数を使用してアドホックリクエストを処理する構成となっています。 最初のLambda関数は着信要求を効率的に処理しますが、2番目のLambda関数はスロットルメトリックスが長くなっており、処理時間が長くなってしまいます。

>この問題を解決するために最適なソリューション設定を選択してください。 （2つ選択してください。）

*A: 両方の関数の同時実行制限を450にする,*
*最初の関数の同時実行制限を減らす*

***
note:

>初めてLambda関数を呼び出すと、AWS Lambda により関数のインスタンスが作成され、イベントを処理するためのハンドラーメソッドが実行されます。関数はレスポンスを返すときに、アクティブなまま待機した上で追加のイベントを処理します。最初のイベントの処理中に関数を再度呼び出すと、Lambda は別のインスタンスを初期化し、関数は 2 つのイベントを同時に処理します。関数の同時実行数は、複数のリクエストを同時に処理するインスタンスの数を指します。最初のトラフィックバーストの場合、リージョンでの関数の累積同時実行数は最初のレベル（500 から 3000 の間）に達する可能性があり、これはリージョンによって異なります。   

>同時実行数のバーストの制限
>3000 – 米国西部 (オレゴン)、米国東部（バージニア北部）、欧州 (アイルランド)
>1000 – アジアパシフィック (東京)、欧州 (フランクフルト)
>500 – その他のリージョン 

>東京リージョンでは、1000の同時実行制限が課せられています。アカウントの同時実行制限が1000で、10の機能がある場合、1つの機能の制限を200に、別の機能の制限を100に指定できます。残りの700は他の8つの機能で共有されます。AWS Lambdaは、予約されていない同時実行プールを最低100の同時実行で保持する必要があり、アカウントの合計制限が1000である場合、900を個々の機能に割り当てることに制限されます。
したがって、このシナリオでの正しいソリューションは次のとおりです。両方の関数の同時実行制限を450に設定することで、900以内の同時実行数に制限することです。オプション１が正解となります。 

>このシナリオでは、同時実行制限内で最初のLambda関数に同時実行数が偏って実行されている可能性が高いです。よって、最初の関数の同時実行制限を減らすことで、2つ目のLambda関数での同時実行数を増加させることも解決策となります。したがって、オプション３も正解となります。 

* LambdaのMaxの実行数は-100！100は余らせる必要あり

## 質問7:不正解
>あなたの会社はEC2インスタンスのAuto ScalingグループとALBで構成されるWebアプリケーションを利用しています。同じWebアプリケーションバージョンが複数のEC2インスタンスにホストされ、Auto Scalingグループが設定されています。 アプリケーションはSTSを使用して資格情報を取得しゲストユーザーへのアクセスを許可します。しかしながら、このゲストユーザーは途中でアクセスできなくなってしまいました。

>この問題の最も可能性の高い原因は何でしょうか？

*A: 資格条件が1時間後に有効期限が切れてしまうため*

***
note:

* STS = Security Token Service
* 一時的なアクセス権限は900秒（15分）から最大3,600秒（1時間）の範囲で有効期限が設定可能
* デフォルトでは最大の1時間に設定される

## 質問8:不正解
>企業はAWS上でCodeシリーズを利用してCI / CD開発環境を整備して、アプリケーションを構築しています。あなたは開発者として、CodeDeployを使用してアプリケーションをAWSのさまざまなコンピューティングプラットフォームにインプレースデプロイする対応を行っています。

>CodeDeployのインプレースデプロイとして正しい内容を選択してください。（2つ選択してください。）

*A: EC2はインプレーすデプロイタイプを使用できる,*
*オンプレミスアプリケーションはインプレースデプロイタイプを使用できる*

***
note:
* インプレースデプロイは停止時間ありでEC2とオンプレミスのみに対応しており、ECSやLambda関数には適用されない

>■インプレイスデプロイ
デプロイグループの各インスタンス上のアプリケーションが停止され、最新のアプリケーションリビジョンがインストールされて、新バージョンのアプリケーションが開始され検証されます。ロードバランサーを使用すれば、各インスタンスがデプロイ中に登録解除され、デプロイ完了後にサービスに復元されるようにすることができます。インプレイスデプロイは、EC2/オンプレミス コンピューティングプラットフォーム使用するデプロイでのみ使用できます。 

>■Blue/Green デプロイ
デプロイの動作は使用するコンピューティングプラットフォームによって異なります。  EC2/オンプレミス コンピューティングプラットフォームの Blue/Greenデプロイではデプロイグループのインスタンス (元の環境) がインスタンスの別のセット (置き換え先環境) に置き換えられます。

## 質問9:不正解
>B社はAWSのサーバレスアーキテクチャを社内で新規採用することになり、その知識獲得を開発部門で実施しているところです。まずはCloudFormationを使用して、単純なnode.jsコードのLambda関数をデプロイすることを計画しています。

>この要件を満たすことができる、最適なデプロイ方法を選択してください。

*A: CloudFormationテンプレートのAWS::Lambda::FunctionリソースのZipFileパラメータに関数ソースをインラインで含める*

***
note:

* AWS::Lambda::FunctionリソースのZipFileパラメータにインラインで埋め込めるのは、Node.jsとPython

>デプロイパッケージは、関数コードと依存関係を含む ZIP アーカイブです。Lambda API を使用して関数を管理する場合や、AWS SDK 以外のライブラリや依存関係を含める必要がある場合は、デプロイパッケージを作成する必要があります。パッケージを Lambda に直接アップロードするか、Amazon S3 バケットを使用して Lambda にアップロードすることができます。

>CloudFormationテンプレートを使用している場合、Lambda関数を作成するAWS :: Lambda :: Functionリソースを設定できます。 AWS :: Lambda :: Functionリソースの下で、Lambda関数のデプロイパッケージを含むCodeプロパティを使用できます。Node.jsおよびPython関数の場合、テンプレートで関数コードをインラインで指定できます。 Amazon S3のデプロイメントパッケージへの変更は、スタックの更新中に自動的に検出されません。機能コードを更新するには、テンプレートのオブジェクトキーまたはバージョンを変更します。したがって、CloudFormationテンプレートのAWS :: Lambda :: FunctionリソースのZipFileパラメーターに関数ソースをインラインで含めることが正しい内容です。 

## 質問10:不正解
>B社ではAWSを使用したハイブリッドクラウドアーキテクチャを採用しました。一部インフラやアプリケーションをAWSへと移行することが必要となっており、その一環としてCross-Origin Resource Sharing (CORS)を利用してAmazon S3を使用した静的ウェブサイトのセットアップを実施する必要があります。

>このシナリオにおける適切なS3の設定方法を選択してください。（2つ選択してください。）

*A: 静的ウェブサイトとしているドメインからS3バケット内のオブジェクトを表示、追加、削除、更新することを許可する,*
*XMLドキュメントによりCORS設定を作成する* 

***
note:

* Cross-Origin Resource Sharing (CORS) は、特定のドメインにロードされたクライアントからドメイン内の別のリソースと通信する方法
* 例えばフロントのjsはコンパイルして、S3に置いてそこからEC2などのサーバーにアクセスするなどができる

>Cross-Origin Resource Sharing (CORS) は、特定のドメインにロードされたクライアントウェブアプリケーションが異なるドメイン内のリソースと通信する方法を定義します。CORS のサポートにより、Amazon S3 を使用して機能豊富なクライアント側ウェブアプリケーションを構築し、Amazon S3 リソースに対するクロスオリジンアクセスを選択的に許可することができるようになりました。

>クロスオリジンリクエストを許可するようにバケットを設定するには、CORS 設定を作成します。これは、バケットへのアクセスを許可するオリジン、各オリジンをサポートするオペレーション (HTTP メソッド)、およびその他のオペレーション固有の情報を識別するルールを含む XML ドキュメントです。 設定には、最大 100 のルールを追加できます。XML ドキュメントを cors サブリソースとしてバケット にプログラムで追加するか、または Amazon S3 コンソールを使用して追加します。  

>ルールとして、http://www.example1.com オリジンからのクロスオリジン PUT、POST、および DELETE リクエストを許可します。このルールは、Access-Control-Request-Headers ヘッダーによって、プリフライト OPTIONS リクエスト内のすべてのヘッダーも許可します。プリフライト OPTIONS リクエストへのレスポンスとして、Amazon S3 はリクエストされたヘッダーを返します。ユーザーがドメインからS3バケット内のオブジェクトを表示、追加、削除、または更新を許可することで　ブラウザーはプリフライトOPTIONSリクエストのAmazon S3レスポンスを1時間キャッシュすることができます。

## 質問11:不正解
>開発部門では開発、テスト、および本番環境のデプロイプロセスを自動化するため、CloudFormationテンプレートを使用することになりました。テンプレートは定期的に更新され、最新のAMI IDを利用できるように展開プロセスを自動化する対応が必要です。

>新しいAMIがリリースされた際に最新AMIにアップデートする最適な方法を選択してください。（2つ選択してください。）

*A: Systems Managerパラメータストアを利用してCloudFormationテンプレートに最新のAMI IDを取得する,*
*AMIを更新する場合は、CloudFormationスタックを更新する*

***
note:

* パラメータストアに変更の可能性のあるリソース情報を持っておき、それをCloudFormationから参照するようにすればそのパラメータストアの内容を変えるだけで全てのそのリソース情報を一括で変えることができる

* パラメータを変更したあとはCloudFormationを再度実行することで、値が変わってリソースが作成される

## 質問12:不正解
>A社はAWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成した新しいサーバーレスアーキテクチャを構築しています。Lambda関数は非プロキシLambda統合によってAPI Gatewayと統合しています。このアプリケーションを実行するためには、Lambda関数のコンシューマーがデータを取得するために要求にdataTypeという名前のクエリ文字列パラメーターを含める必要があります。

>この要件を満たすために、最適な実装方式を選択してください。

*A: *

***
note:

* 

>