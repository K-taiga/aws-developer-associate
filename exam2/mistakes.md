##　質問1
>あなたはAWS専門のエンジニアとして、IoTデータをキャプチャしてAmazon Kinesis Data Streamsに送信するモバイルアプリケーションを構築しています。このアプリケーションは、EC2インスタンスを利用してKCLをインストールしてKinesisと連携しています。 カスタムメトリックに基づいて、インスタンスがCPU使用率を最大限に活用しており、Amazon Kinesis Data Streamsに流れるデータレートを処理するにはKinesisのシャードが不十分なようです。

>この問題を解決するためのソリューションを選択してください。（2つ選択してください。）

*A: 利用しているEC2インスタンスのインスタンスサイズを増強する,Kinesisシャードを分割する*

***
note:

* シャードは分けると処理が上がる、逆にマージして処理を下げる
* Kinesisのストリーム処理能力を高める場合は、インスタンスサイズを増強させる

>■リシャーディング
シャードの分割では１ つのシャードを 2 つシャードに分けます。シャードの結合では、2 つシャードを 1 つのシャードに組み合わせます。リシャーディングは、1 回のオペレーションでシャードに分割できる数と 1 回のオペレーションで結合できるシャードの数が 2 個以下に限られるという意味で、常にペアワイズです。リシャーディングオペレーションの対象となるシャードまたはシャードペアは、親シャードと呼ばれます。リシャーディングオペレーションを実行した結果のシャードまたはシャードペアは、子シャードと呼ばれます。 分割によりストリーム内のシャードの数が増えストリームのデータ容量は増えます。シャード単位で請求されるため、分割によりストリームのコストが増えます。

>■シャードに合わせたインスタンスサイズの増強
Kinesisストリーム内のインスタンスのサイズとシャードの数を増やすことで、インスタンスがインスタンス内で並行して実行されるより多くのレコードプロセッサを処理できるようにします。 また、ストリームが送信されるデータのレートに適切に対応できるようにします。ストリームのデータ容量は、ストリームに指定するシャードの数の関数です。

## 質問2
>Fintech企業A社はビットコインなどの暗号通貨を売買できる仮想通貨取引プラットフォーム事業を開始しました。金融サービスとなるため高いコンプライアンス要件が仮想通貨取引所には求められており、厳格なIT監査を受ける必要があります。 あなたは監査に向けて、KMSの機能として暗号化を進めるように求められています。

>AWS KMSの暗号化プロセスの説明として合致してる内容はどれでしょうか？（2つ選択してください。
）

*A: KMSは毎回キーを回転させることができる,KMSはKMSに保存されているマスターキーを使用して暗号化する*

***
note:

* AWS KMS のカスタマーマスターキー (CMK) の新しい暗号化マテリアルを作成するために、新しい CMK を作成した後、アプリケーションまたはエイリアスを変更して新しい CMK を使用できる
または、既存の CMK の自動キーローテーションを有効にすることもできる
* マスターキーを元に暗号化するかマスターキーを回転して新たに暗号キーを作成できる

>■データの暗号化、復号、再暗号化 プレーンテキストでサービスからエクスポートできるデータ暗号化キー、またはサービスから持ち出せないマスターキーで暗号化されたデータ暗号化キーを生成します。

>■暗号化アプリケーションに適したランダムな数値を生成します。AWS KMS を使用することで、暗号化するデータへのアクセスをより詳細に制御できます。キー管理および暗号化機能を直接アプリケーションで使用するか、AWS KMS と統合される AWS サービスを通じて使用できます。AWS のアプリケーションを作成しているか、AWS サービスを使用しているかにかかわらず、AWS KMS ではマスターキーを使用できるユーザー、暗号化されたデータにアクセスできるユーザーを制御できます。

## 質問3
>あなたはソリューションアーキテクトとして、ヘルステックベンチャーにおいてAWSでホストされた健康管理アプリケーションの開発を行っています。このアプリケーションはCloudFormationスタックを利用してグローバルにインフラが展開されています。現在のスタック構成は以下の通りです。

>■東京リージョンにスタック「Health1」を作成：Outputに「NewStack」を出力<br>
>■シンガポールリージョンにスタック「Health2」を作成：Outputに「NewStack」を出力

>シンガポールリージョンにスタック「Health1」をデプロイしたところ、エラーが発生しました。その原因は何でしょうか？

*A: AWSアカウントごとに、エクスポート名はリージョン内で一意である必要があるため、エクスポート名を変更する必要がある。*

***
note:

* CloudFormationではAWSアカウントごとに、エクスポート名はリージョン内で一意である必要がある(同一アカウント、同一リージョン内では同じエクスポート名はだめ！)

>次のような制限がクロススタックの参照に適用されます 

>・各AWS アカウントの場合は、エクスポート名はリージョン内で一意である必要があります。<br>
>・リージョンにわたるクロススタックの参照を作成することはできません。同じリージョンFn::ImportValue内では、エクスポートされた値のみインポートするのに組み込み関数を使用できます。<br>
>・出力はName プロパティ (Export に属す) の値で、リソースに依存する Ref または GetAtt 関数を使うことはできません。<br>
>・同様に、ImportValue 関数にリソースに依存する Ref または GetAtt 関数を含むことはできません。<br>
>・他のスタックから参照されている出力が存在する場合は、スタックを削除することはできません。<br>
>・別のスタックで参照した出力値を変更したり削除することはできません。

## 質問6
>あなたの会社はEC2インスタンスのAuto ScalingグループとALBで構成されるWebアプリケーションを利用しています。さらにデフォルトのドメイン名を持つCloudFrontを使用してコンテンツを配信しています。さらに、安全な通信を確立するためにビューアとCloudFront間のHTTPS通信を設定することになりました。

>この要件を満たすためにCloudFrontで実施するべき設定は何でしょうか？（2つ選択してくさい。）

*A: CloudFrontのビューアプロトコルポリシーにRedirect HTTP to HTTPSを設定する,<br>CloudFrontのビューアプロトコルポリシーにHTTPS Onlyを設定する*

***
note:

* 開発者としてビューアとCloudFront間のHTTPS通信を設定するためには、<br>
「Redirect HTTP to HTTPS」または「HTTPS Only」を使用するようにビューアプロトコルポリシーを設定することが必要
* ビューアがHTTPできたらHTTPSで返すのとHTTPSでしかアクセスできないようにする

>CloudFrontがディストリビューションに割り当てたドメイン名を使用している場合、1つ以上のキャッシュ動作のビューアープロトコルポリシー設定を変更して、 Redirect HTTP to HTTPSまたはHTTPS Onlyを設定することでHTTPS通信を要求できます。オリジンがELBロードバランサーの場合、AWS Certificate Manager（ACM）が提供する証明書を使用できます。

## 質問7
>A社では開発環境などは全てDocker形式で展開できるようにECSを使用した新アプリケーションを構築しています。このアプリケーションでは、ポートマッピングを使用してネットワークトラフィックを送受信できるように コンテナの設定が必要です。

>このタスクを適切に実装するためには、どのECS機能を設定する必要がありますか？

*A: タスク定義*

***
note:

* Dockerコンテナーがポートマッピングを使用してネットワークトラフィックを送受信できるようにするためには、Amazon ECSにおいてタスク定義を設定する
* コンテナエージェントはコンテナインスタンスがクラスタに接続することのみを許可するためのもの

> Amazon ECS で Docker コンテナを実行するためにタスク定義が必要です。<br>
タスク定義は、タスクファミリー、IAM タスクロール、ネットワークモード、コンテナ定義、ボリューム、タスク配置の制約事項、起動タイプの各部分に分かれています。ファミリーとコンテナ定義はタスク定義に必須ですが、タスクロール、ネットワークモード、ボリューム、タスク配置の制約事項、起動タイプはオプションです。

## 質問8
>あなたはサーバレスを得意とした開発者としてA社に勤務しています。現在は、CloudFormationを使用して、API GatewayからLambdaを呼び出して、DynamoDBへとデータを記録・取得するサーバーレスアプリケーションをデプロイしています。 その際に、AWS SAM構文において、SAMバージョンを指定する必要があるテンプレートでリソースを宣言することが必要です。

>CloudFormationテンプレートにおいて、リソースセクション以外に設定するべき内容を選択してください。（2つ選択してください。）

*A: AWS::ServerlessにAWS SAMのバージョンを指定する,AWS::ServerlessオプションのTransformを設定する*

***
note:

* Lambdaなのでサーバーレスの設定を選ぶ問題
* AWS::Serverless Transformの設定でSAMのバージョンを指定する必要がある
* AWS SAMを利用してサーバーレスアプリケーションをCloudFormationで展開する

## 質問11
>あなたが開発したサーバーレスアプリケーションは、複数のAPI Gatewayを利用してアプリケーションのリリースライフサイクルごとにLambdaを呼び出して、ユーザーから送信されたアドホックリクエストを処理します。このアプリのリリースは他のアプリケーションへの影響を考慮しながら段階的に実施されます。要件としては、リリース段階に応じて、異なるバックエンドのエンドポイントとやり取りを変更することが求められています。

>段階的なリリースを実現するための設定方法を選択してください

*A: 各リリースにおいてステージ変数を設定する*

***
note:

* 各サーバーレスAPIはデプロイ先としてステージをもち、それぞれ異なるバージョンのAPIを公開できる

>ステージ変数は、REST API のデプロイステージと関連付けられた設定属性として定義できる名前と値のペアです。環境変数と同様に機能し、API のセットアップやマッピングテンプレートで使用できます。 各リリースにおいてステージ変数を設定することで、リリースの段階を管理することができます。API Gateway のデプロイステージでは、アルファ、ベータ、プロダクションなど、各 API 用の複数のリリースステージを管理できます。ステージ変数を使用することで、異なるバックエンドのエンドポイントとやり取りするよう API デプロイステージを設定できます

## 質問12
>あなたはAWSを利用してサーバレスアプリケーションを構築している開発者です。 Lambdaプロキシ統合を使用してLambda関数とAPI Gatewayを統合した新しいアプリケーションを構築しました。しかしながら、呼び出しURLを使用してAPI Gatewayを呼び出すと、接続拒否エラーが発生します。

>この問題の最も可能性の高い原因はどれでしょうか？

*A: APIを呼び出す際にHTTPSエンドポイントを利用していない*

***
note:

* API Gatewayはサーバーレスの完全マネージドサービスで,Lambda等を使ってRESTfulなAPIやWebsocketAPIを完全サーバーレスで実現することができる
* Amazon API Gateway で作成された API はすべて、HTTPS エンドポイントのみ公開される

## 質問13
>開発者はAWS上でWEBアプリケーションを構築しました。このアプリケーションのバグ修正やパフォーマンス最適化のためにAWS X-Rayを使用して、実行中のWebアプリケーションをトレースする必要があります。アプリケーションによって送信されるセグメントドキュメントには、特定のデータを識別するときに利用する「Annotation(注釈)」があり、これを利用して適切なセグメント検索やトレースを実施することが必要です。

>適切なセグメント検索やトレースを実施するために、AWS X-Rayの適切な設定方法を選択してください。（2つ選択してください。）

*A: X-Rayコンソールにおいてフィルタ式を選択する,<br>GetTraceSummariesAPIを使用して、特定の情報に関連づけられたセグメントを検索する*

***
note:

* AWS X-Rayではフィルタ式を使用して検索するトレースだけに結果を絞り込むことができ、X-RayコンソールまたはGetTraceSummaries APIを使用して、特定の情報に関連付けられたセグメントを検索できる

>フィルタ式は、特定のサービスノードまたはエッジにヒットするエラーや、既知のユーザーからのトレースされた要求をターゲットにできます。 たとえば、次のフィルター式は、api.example.comを通過するトレースを対象としています。 

>service（ "api.example.com"） 

>このフィルター式は、値が12345のaccountという名前の注釈を持つトレースを検索します。

>annotation.account = "12345"

>GetTraceSummariesはフィルタ式を使用して、指定された時間枠で使用可能なトレースのIDと注釈を取得します。 完全なトレースを取得するには、BatchGetTracesにトレースIDを渡します。

## 質問17
>あなたはアプリ開発・導入担当として、Elastic Beanstalkを利用したWEBアプリケーションをデプロイしています。定期的なタスクとしてElastic BeanstalkによってWEBアプリケーションのバージョン更新を実施していますが、その際にインプレース更新を実行しており、その間はアプリケーションを使用できなくなります。あなたは一時的なアプリケーションが利用不可となる現状を回避するため、DNSスイッチを使用してトラフィックを新しいバージョンにリダイレクトする構成を設定しています。

>この要件を達成するためのAWS Elastic Beanstalkの展開方式を選択してください。

*A: Blue-Green Deployment*

***
note:

* DNSスイッチを使用してトラフィックを新しいバージョンにリダイレクトする設定というのがミソ

>アプリケーションのバージョンを更新するときに AWS Elastic Beanstalk がインプレース更新を実行するため、アプリケーションはわずかな期間、ユーザーに利用不可になることがあります。その際にBlue-Green Deployment を実行することで、このダウンタイムを回避できます。この場合、個別の環境に新しいバージョンをデプロイしてから、2 つの環境の CNAME を入れ替えて、すぐに新しいバージョンにトラフィックをリダイレクトします。

>Blue-Green Deployment では、アプリケーションがプロダクションデータベースを使用する場合、ユーザーの環境がそのデータベースから独立して実行される必要があります。ユーザーの環境に Amazon RDS DB インスタンスがアタッチされている場合、データはもう一方の環境に転送されず、元の環境が終了した場合に失われます。 

## 質問18
>A社ではアプリケーション展開と連携のためにAPIを多数利用しています。現在、あなたはアプリケーションを使用してテキストメッセージを送受信できるような機能開発を実施しているところです。 REST APIを利用して、高可用性とスケーラビリティを実現する実装が必要です。

>AWSにおいてREST APIの実装に使用できるサービスの組み合わせを選択してください。（2つ選択してください。）

*A: API Gateway + Lambda, ALB + ECS*

***
note:

* API Gateway + LambdaでスケーラブルなRESTfulなAPIを提供できるというのは質問12の通り
* ECSもDockerコンテナー管理プラットフォームであり、ALBなどのロードバランサーと併用すると、スケーラブルで負荷分散されたREST APIを提供できる

## 質問19
>ある会社ではユーザー設定情報などのデータ管理にDynamoDBを利用しています。あなたはデータベース開発者として、DynamoDBを使用してデータ読込処理を実装しています。その際には、いくつかの属性を部分的に取得することで効率的なデータ処理を実現する必要があります。 

>どのようにDynamoDBの設定をする必要がありますか？

*A: ProjectionExpressionを利用する*

***
note:

* query メソッド内で設定するProjectionExpressionは必要な属性を識別する文字列
* いくつかの属性を部分的に取得することで効率的なデータ処理を実現する=>ProjectionExpression!!

>DynamoDBではquery メソッドを使用して、テーブルからデータを取得できます。このためにはパーティションキーの値を指定する必要があります。 query メソッド内で設定するProjectionExpressionは必要な属性を識別する文字列です。これによって、属性を限定したデータ取得を実行することができます。 単一の属性を取得するには、名前を指定します。 複数の属性の場合、名前はコンマで区切る必要があります。

>Scan メソッドはテーブル全体のすべての項目を読み込み、テーブルの全データを返します。オプションで filter_expression を提供して、条件に一致する項目だけが返されるように指定できます。ただし、テーブル全体がスキャンされた後にのみ、フィルタが適用されます。この設定は本件の内容では利用しないため正しくありません。
