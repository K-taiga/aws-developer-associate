##　質問1
>あなたはAWS専門のエンジニアとして、IoTデータをキャプチャしてAmazon Kinesis Data Streamsに送信するモバイルアプリケーションを構築しています。このアプリケーションは、EC2インスタンスを利用してKCLをインストールしてKinesisと連携しています。 カスタムメトリックに基づいて、インスタンスがCPU使用率を最大限に活用しており、Amazon Kinesis Data Streamsに流れるデータレートを処理するにはKinesisのシャードが不十分なようです。

>この問題を解決するためのソリューションを選択してください。（2つ選択してください。）

*A: 利用しているEC2インスタンスのインスタンスサイズを増強する,Kinesisシャードを分割する*

***
note:

* シャードは分けると処理が上がる、逆にマージして処理を下げる
* Kinesisのストリーム処理能力を高める場合は、インスタンスサイズを増強させる

>■リシャーディング
シャードの分割では１ つのシャードを 2 つシャードに分けます。シャードの結合では、2 つシャードを 1 つのシャードに組み合わせます。リシャーディングは、1 回のオペレーションでシャードに分割できる数と 1 回のオペレーションで結合できるシャードの数が 2 個以下に限られるという意味で、常にペアワイズです。リシャーディングオペレーションの対象となるシャードまたはシャードペアは、親シャードと呼ばれます。リシャーディングオペレーションを実行した結果のシャードまたはシャードペアは、子シャードと呼ばれます。 分割によりストリーム内のシャードの数が増えストリームのデータ容量は増えます。シャード単位で請求されるため、分割によりストリームのコストが増えます。

>■シャードに合わせたインスタンスサイズの増強
Kinesisストリーム内のインスタンスのサイズとシャードの数を増やすことで、インスタンスがインスタンス内で並行して実行されるより多くのレコードプロセッサを処理できるようにします。 また、ストリームが送信されるデータのレートに適切に対応できるようにします。ストリームのデータ容量は、ストリームに指定するシャードの数の関数です。

## 質問2
>Fintech企業A社はビットコインなどの暗号通貨を売買できる仮想通貨取引プラットフォーム事業を開始しました。金融サービスとなるため高いコンプライアンス要件が仮想通貨取引所には求められており、厳格なIT監査を受ける必要があります。 あなたは監査に向けて、KMSの機能として暗号化を進めるように求められています。

>AWS KMSの暗号化プロセスの説明として合致してる内容はどれでしょうか？（2つ選択してください。
）

*A: KMSは毎回キーを回転させることができる,KMSはKMSに保存されているマスターキーを使用して暗号化する*

***
note:

* AWS KMS のカスタマーマスターキー (CMK) の新しい暗号化マテリアルを作成するために、新しい CMK を作成した後、アプリケーションまたはエイリアスを変更して新しい CMK を使用できる
または、既存の CMK の自動キーローテーションを有効にすることもできる
* マスターキーを元に暗号化するかマスターキーを回転して新たに暗号キーを作成できる

>■データの暗号化、復号、再暗号化 プレーンテキストでサービスからエクスポートできるデータ暗号化キー、またはサービスから持ち出せないマスターキーで暗号化されたデータ暗号化キーを生成します。

>■暗号化アプリケーションに適したランダムな数値を生成します。AWS KMS を使用することで、暗号化するデータへのアクセスをより詳細に制御できます。キー管理および暗号化機能を直接アプリケーションで使用するか、AWS KMS と統合される AWS サービスを通じて使用できます。AWS のアプリケーションを作成しているか、AWS サービスを使用しているかにかかわらず、AWS KMS ではマスターキーを使用できるユーザー、暗号化されたデータにアクセスできるユーザーを制御できます。

## 質問3
>あなたはソリューションアーキテクトとして、ヘルステックベンチャーにおいてAWSでホストされた健康管理アプリケーションの開発を行っています。このアプリケーションはCloudFormationスタックを利用してグローバルにインフラが展開されています。現在のスタック構成は以下の通りです。

>■東京リージョンにスタック「Health1」を作成：Outputに「NewStack」を出力<br>
>■シンガポールリージョンにスタック「Health2」を作成：Outputに「NewStack」を出力

>シンガポールリージョンにスタック「Health1」をデプロイしたところ、エラーが発生しました。その原因は何でしょうか？

*A: AWSアカウントごとに、エクスポート名はリージョン内で一意である必要があるため、エクスポート名を変更する必要がある。*

***
note:

* CloudFormationではAWSアカウントごとに、エクスポート名はリージョン内で一意である必要がある(同一アカウント、同一リージョン内では同じエクスポート名はだめ！)

>次のような制限がクロススタックの参照に適用されます 

>・各AWS アカウントの場合は、エクスポート名はリージョン内で一意である必要があります。<br>
>・リージョンにわたるクロススタックの参照を作成することはできません。同じリージョンFn::ImportValue内では、エクスポートされた値のみインポートするのに組み込み関数を使用できます。<br>
>・出力はName プロパティ (Export に属す) の値で、リソースに依存する Ref または GetAtt 関数を使うことはできません。<br>
>・同様に、ImportValue 関数にリソースに依存する Ref または GetAtt 関数を含むことはできません。<br>
>・他のスタックから参照されている出力が存在する場合は、スタックを削除することはできません。<br>
>・別のスタックで参照した出力値を変更したり削除することはできません。

## 質問6
>あなたの会社はEC2インスタンスのAuto ScalingグループとALBで構成されるWebアプリケーションを利用しています。さらにデフォルトのドメイン名を持つCloudFrontを使用してコンテンツを配信しています。さらに、安全な通信を確立するためにビューアとCloudFront間のHTTPS通信を設定することになりました。

>この要件を満たすためにCloudFrontで実施するべき設定は何でしょうか？（2つ選択してくさい。）

*A: CloudFrontのビューアプロトコルポリシーにRedirect HTTP to HTTPSを設定する,<br>CloudFrontのビューアプロトコルポリシーにHTTPS Onlyを設定する*

***
note:

* 開発者としてビューアとCloudFront間のHTTPS通信を設定するためには、<br>
「Redirect HTTP to HTTPS」または「HTTPS Only」を使用するようにビューアプロトコルポリシーを設定することが必要
* ビューアがHTTPできたらHTTPSで返すのとHTTPSでしかアクセスできないようにする

>CloudFrontがディストリビューションに割り当てたドメイン名を使用している場合、1つ以上のキャッシュ動作のビューアープロトコルポリシー設定を変更して、 Redirect HTTP to HTTPSまたはHTTPS Onlyを設定することでHTTPS通信を要求できます。オリジンがELBロードバランサーの場合、AWS Certificate Manager（ACM）が提供する証明書を使用できます。

## 質問7
>A社では開発環境などは全てDocker形式で展開できるようにECSを使用した新アプリケーションを構築しています。このアプリケーションでは、ポートマッピングを使用してネットワークトラフィックを送受信できるように コンテナの設定が必要です。

>このタスクを適切に実装するためには、どのECS機能を設定する必要がありますか？

*A: タスク定義*

***
note:

* Dockerコンテナーがポートマッピングを使用してネットワークトラフィックを送受信できるようにするためには、Amazon ECSにおいてタスク定義を設定する
* コンテナエージェントはコンテナインスタンスがクラスタに接続することのみを許可するためのもの

> Amazon ECS で Docker コンテナを実行するためにタスク定義が必要です。<br>
タスク定義は、タスクファミリー、IAM タスクロール、ネットワークモード、コンテナ定義、ボリューム、タスク配置の制約事項、起動タイプの各部分に分かれています。ファミリーとコンテナ定義はタスク定義に必須ですが、タスクロール、ネットワークモード、ボリューム、タスク配置の制約事項、起動タイプはオプションです。

## 質問8
>あなたはサーバレスを得意とした開発者としてA社に勤務しています。現在は、CloudFormationを使用して、API GatewayからLambdaを呼び出して、DynamoDBへとデータを記録・取得するサーバーレスアプリケーションをデプロイしています。 その際に、AWS SAM構文において、SAMバージョンを指定する必要があるテンプレートでリソースを宣言することが必要です。

>CloudFormationテンプレートにおいて、リソースセクション以外に設定するべき内容を選択してください。（2つ選択してください。）

*A: AWS::ServerlessにAWS SAMのバージョンを指定する,AWS::ServerlessオプションのTransformを設定する*

***
note:

* Lambdaなのでサーバーレスの設定を選ぶ問題
* AWS::Serverless Transformの設定でSAMのバージョンを指定する必要がある
* AWS SAMを利用してサーバーレスアプリケーションをCloudFormationで展開する

## 質問11
>あなたが開発したサーバーレスアプリケーションは、複数のAPI Gatewayを利用してアプリケーションのリリースライフサイクルごとにLambdaを呼び出して、ユーザーから送信されたアドホックリクエストを処理します。このアプリのリリースは他のアプリケーションへの影響を考慮しながら段階的に実施されます。要件としては、リリース段階に応じて、異なるバックエンドのエンドポイントとやり取りを変更することが求められています。

>段階的なリリースを実現するための設定方法を選択してください

*A: 各リリースにおいてステージ変数を設定する*

***
note:

* 各サーバーレスAPIはデプロイ先としてステージをもち、それぞれ異なるバージョンのAPIを公開できる

>ステージ変数は、REST API のデプロイステージと関連付けられた設定属性として定義できる名前と値のペアです。環境変数と同様に機能し、API のセットアップやマッピングテンプレートで使用できます。 各リリースにおいてステージ変数を設定することで、リリースの段階を管理することができます。API Gateway のデプロイステージでは、アルファ、ベータ、プロダクションなど、各 API 用の複数のリリースステージを管理できます。ステージ変数を使用することで、異なるバックエンドのエンドポイントとやり取りするよう API デプロイステージを設定できます

## 質問12
>あなたはAWSを利用してサーバレスアプリケーションを構築している開発者です。 Lambdaプロキシ統合を使用してLambda関数とAPI Gatewayを統合した新しいアプリケーションを構築しました。しかしながら、呼び出しURLを使用してAPI Gatewayを呼び出すと、接続拒否エラーが発生します。

>この問題の最も可能性の高い原因はどれでしょうか？

*A: APIを呼び出す際にHTTPSエンドポイントを利用していない*

***
note:

* API Gatewayはサーバーレスの完全マネージドサービスで,Lambda等を使ってRESTfulなAPIやWebsocketAPIを完全サーバーレスで実現することができる
* Amazon API Gateway で作成された API はすべて、HTTPS エンドポイントのみ公開される

## 質問13
>開発者はAWS上でWEBアプリケーションを構築しました。このアプリケーションのバグ修正やパフォーマンス最適化のためにAWS X-Rayを使用して、実行中のWebアプリケーションをトレースする必要があります。アプリケーションによって送信されるセグメントドキュメントには、特定のデータを識別するときに利用する「Annotation(注釈)」があり、これを利用して適切なセグメント検索やトレースを実施することが必要です。

>適切なセグメント検索やトレースを実施するために、AWS X-Rayの適切な設定方法を選択してください。（2つ選択してください。）

*A: X-Rayコンソールにおいてフィルタ式を選択する,<br>GetTraceSummariesAPIを使用して、特定の情報に関連づけられたセグメントを検索する*

***
note:

* AWS X-Rayではフィルタ式を使用して検索するトレースだけに結果を絞り込むことができ、X-RayコンソールまたはGetTraceSummaries APIを使用して、特定の情報に関連付けられたセグメントを検索できる

>フィルタ式は、特定のサービスノードまたはエッジにヒットするエラーや、既知のユーザーからのトレースされた要求をターゲットにできます。 たとえば、次のフィルター式は、api.example.comを通過するトレースを対象としています。 

>service（ "api.example.com"） 

>このフィルター式は、値が12345のaccountという名前の注釈を持つトレースを検索します。

>annotation.account = "12345"

>GetTraceSummariesはフィルタ式を使用して、指定された時間枠で使用可能なトレースのIDと注釈を取得します。 完全なトレースを取得するには、BatchGetTracesにトレースIDを渡します。

## 質問17
>あなたはアプリ開発・導入担当として、Elastic Beanstalkを利用したWEBアプリケーションをデプロイしています。定期的なタスクとしてElastic BeanstalkによってWEBアプリケーションのバージョン更新を実施していますが、その際にインプレース更新を実行しており、その間はアプリケーションを使用できなくなります。あなたは一時的なアプリケーションが利用不可となる現状を回避するため、DNSスイッチを使用してトラフィックを新しいバージョンにリダイレクトする構成を設定しています。

>この要件を達成するためのAWS Elastic Beanstalkの展開方式を選択してください。

*A: Blue-Green Deployment*

***
note:

* DNSスイッチを使用してトラフィックを新しいバージョンにリダイレクトする設定というのがミソ

>アプリケーションのバージョンを更新するときに AWS Elastic Beanstalk がインプレース更新を実行するため、アプリケーションはわずかな期間、ユーザーに利用不可になることがあります。その際にBlue-Green Deployment を実行することで、このダウンタイムを回避できます。この場合、個別の環境に新しいバージョンをデプロイしてから、2 つの環境の CNAME を入れ替えて、すぐに新しいバージョンにトラフィックをリダイレクトします。

>Blue-Green Deployment では、アプリケーションがプロダクションデータベースを使用する場合、ユーザーの環境がそのデータベースから独立して実行される必要があります。ユーザーの環境に Amazon RDS DB インスタンスがアタッチされている場合、データはもう一方の環境に転送されず、元の環境が終了した場合に失われます。 

## 質問18
>A社ではアプリケーション展開と連携のためにAPIを多数利用しています。現在、あなたはアプリケーションを使用してテキストメッセージを送受信できるような機能開発を実施しているところです。 REST APIを利用して、高可用性とスケーラビリティを実現する実装が必要です。

>AWSにおいてREST APIの実装に使用できるサービスの組み合わせを選択してください。（2つ選択してください。）

*A: API Gateway + Lambda, ALB + ECS*

***
note:

* API Gateway + LambdaでスケーラブルなRESTfulなAPIを提供できるというのは質問12の通り
* ECSもDockerコンテナー管理プラットフォームであり、ALBなどのロードバランサーと併用すると、スケーラブルで負荷分散されたREST APIを提供できる

## 質問19
>ある会社ではユーザー設定情報などのデータ管理にDynamoDBを利用しています。あなたはデータベース開発者として、DynamoDBを使用してデータ読込処理を実装しています。その際には、いくつかの属性を部分的に取得することで効率的なデータ処理を実現する必要があります。 

>どのようにDynamoDBの設定をする必要がありますか？

*A: ProjectionExpressionを利用する*

***
note:

* query メソッド内で設定するProjectionExpressionは必要な属性を識別する文字列
* いくつかの属性を部分的に取得することで効率的なデータ処理を実現する=>ProjectionExpression!!

>DynamoDBではquery メソッドを使用して、テーブルからデータを取得できます。このためにはパーティションキーの値を指定する必要があります。 query メソッド内で設定するProjectionExpressionは必要な属性を識別する文字列です。これによって、属性を限定したデータ取得を実行することができます。 単一の属性を取得するには、名前を指定します。 複数の属性の場合、名前はコンマで区切る必要があります。

>Scan メソッドはテーブル全体のすべての項目を読み込み、テーブルの全データを返します。オプションで filter_expression を提供して、条件に一致する項目だけが返されるように指定できます。ただし、テーブル全体がスキャンされた後にのみ、フィルタが適用されます。この設定は本件の内容では利用しないため正しくありません。

## 質問23
>A社ではアプリケーション開発においてAWS CodeCommitとAWS CodeDeployなどを利用して開発・テスト・デプロイまでのパイプラインを利用したCI/CD環境を整備しています。あなたはデプロイ担当者として、AWS CodePipelineを使用して、AWSマネジメントコンソールから新しいパイプラインを作成しました。 プロセスは、GitHubにコミットされたコード変更をプルして、AWS CodeBuildでビルドを生成し、AWS Elastic Beanstalk環境にデプロイされるように構成されています。このCodePipelineを実行したところ、ターゲットとなるElastic Beanstalk環境と連携できないエラーが発生しました。

>CodePipelineの実行エラーの原因を見つけるために、どのような手順をとるべきでしょうか（3つ選択してください。）

*A: CloudFormationで原因を探索する,*<br>
*IAM Policy Simulatorで原因を探索する,*<br>
*CloudTrailで原因を探索する*<br>

***
note:

>Elastic Beanstalkの削除をCloudFormationで検索することで、原因を探索することができます。Elastic BeanstalkはCloudFormationによってサポートされているため、CloudFormationでバッキングスタックが表示されない場合、それがBeanstalk環境が削除された理由であることを意味します。

>対象のElastic Beanstalk環境と連携できずに実行エラーが発生しており、認証関連のトラブルが予測されます。そのため、認証関連のイベントや設定エラーをIAM Policy Simulatorを利用して検索します。IAM Policy Simulator では IAM およびリソースベースのポリシーをテストし、トラブルシューティングできます。 Policy Simulator は、選択されたポリシーを評価し、指定された各アクションに対して有効なアクセス許可を特定します。このシミュレーターでは、AWS のサービスに対する実際のリクエストで使用されるものと同じポリシー評価エンジンが使用されます。

>Elastic Beanstalk関連のイベントをCloudTrailで検索して原因を探索します。CloudTrail を使用すると、AWS インフラストラクチャ全体でアカウントアクティビティをログに記録し、継続的に監視し、保持できます。CloudTrail では、AWS マネジメントコンソール、AWS の SDK やコマンドラインツール、その他の AWS のサービスを使用して実行されるアクションなど、AWS アカウントアクティビティのイベント履歴を把握できます。 

## 質問24
>B社では現在、多くのユーザーに利用される予定のWEBアプリケーション開発を実施しており、あなたはAmazon Kinesis Data Streamsのデータ処理を担当しており、現在はAPI Gatewayと連携したAWS Lambdaを使用して、Kinesisによりデータ取得処理を開発しています。これらのデータはWebサイトをナビゲートするユーザーからのクリックストリームです。データボリュームの増加に応じて、Amazon Kinesis Data Streamsが時間とともにスケール可能とする設定を依頼されました。

>この要件を満たすためには、どのアクションを実行することが必要となりますか？（2つ選択してください。）

*A: シャードを追加する,パーティションキーに多数の異なる値が必要となる*

***
note:

* Kinesis Data Streamsにはオートスケーリングはない！シャードを分割する！
* ボリュームの増加によりKinesis Data Streamsが時間とともにスケール可能とするためには、パーティションキーに多数の異なる値が必要 
* パーティションキーは、ストリーム内のデータをシャード別にグループ化するため
* ストリームの保持期間は、デフォルトで作成後 24 時間

## 質問25
>ある会社ではAWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成した新しいサーバーレスアーキテクチャを実装しています。 あなたは担当エンジニアとして、いくつかのAWS Lambda関数を起動しましたが、 1MBを超えるデータを関数に渡し、実行時に暗号化および復号化する必要があるという新しい要件が与えられました。

>このデータ暗号化の要件に適した方法を選択してください。

*A: 暗号化SDKを使用して、暗号化されたファイルをLambda関数でエンベロープして保存する*

***
note:

* AWS Lambda環境変数の最大サイズは512KBで、AWS KMSの「暗号化」APIには数KBの制限があります。 1 MBを暗号化するには、暗号化SDKを使用して、暗号化されたファイルをLambda関数でエンベロープする必要があります

* Lambdaで暗号化するにはKMSのキーと暗号化ヘルパーを使うがそれは512KBまで
* だから暗号化SDKを使ってLambda側で展開する

> AWS Lambda関数上のデータを暗号化するためには、環境変数を使用して、シークレットを安全に保存して Lambda 関数で使用できます。Lambda は保管状態の環境変数を常に暗号化します。さらに、以下の機能を使用して、環境変数がどのように暗号化されるかをカスタマイズできます。

>■キー設定
関数ごとに Lambda を設定して、AWS Key Management Service で作成し、管理する暗号化キーを使用できます。これらは、カスタマー管理のカスタマーマスターキー (CMK) またはカスタマー管理型のキーと呼ばれます。カスタマー管理型のキーを設定しない場合、Lambda は、Lambda がアカウントで作成する、aws/lambda という名前の AWS 管理型 CMK を使用します。 

>■暗号化ヘルパー
Lambda コンソールを使用すると、環境変数の値を Lambda に送信する前に、クライアント側で暗号化できます。これにより、Lambda コンソール、または Lambda API に返される関数の設定で、シークレットが暗号化されずに表示されることを防止できるため、セキュリティがさらに強化されます。また、コンソールでは、関数ハンドラーの値を復号化するために調整できるサンプルコードも利用できます。 
しかしながら、AWS Lambda環境変数の最大サイズは512KBで、AWS KMSの「暗号化」APIには数KBの制限があるため、上記の標準的な暗号化手段だけでは１MBのデータ暗号化は実現不可能です。 したがって、1 MBを暗号化するには、暗号化SDKを使用して、暗号化されたファイルをLambda関数でエンベロープする必要があります。

## 質問26
>B社ではAWSを利用したアプリケーション開発を行っています。開発者向けにはAWSサービスへのアクセスを許可するアクセスキーとシークレットアクセスキーを持つIAMユーザーアカウントを提供しました。開発者から開発環境においてCodeBuildのビルド実行が失敗するという報告があがりました。しかしながら、適切なメトリクスが取得できておらず原因が特定できないようです。そこで、CodeBuildのビルド実行エラーを確認するための設定を行います。

>失敗したビルドのログを確認する方法を選択してください。（2つ選択してください。）

*A: CloudTrail,S3とCloudWatch統合を有効にする*

***
note:

* CloudTrailを有効化することで AWS CodeBuildのログを取得することができる
* S3とCloudWatchの統合を有効にすることで、CodeBuildによってS3にアップロードされた実行データへのログを確認することができる

> CodeBuildはビルド出力がある場合、その出力データをAmazon S3バケットにアップロードします。 ビルドの実行中に、AWS CodeBuildコンソール、AWS CLI、またはAWS SDKを使用して、AWS CodeBuildから要約ビルド情報を取得し、Amazon CloudWatch Logsから詳細なビルド情報を取得できます。

## 質問27
>B社ではAWSを利用したアプリケーション開発を行っています。このアプリケーションはALBを設定した複数のEC2インスタンスで構成されています。要求を行っているクライアントのIPアドレスを取得し、そのIPアドレスに返答する処理が必要となりますが、テストしてみると、ALBのIPアドレスばかりが取得されているようです。

>クライアント固有のIPアドレスを取得する方法を選択してください。

*A: バックエンドのX-Forwarded-Forヘッダーを確認する*

***
note:

> ELBはクライアントの IP アドレスを X-Forwarded-For リクエストヘッダーに格納し、このヘッダーをサーバーに渡します。 したがって、 X-Forwarded-For リクエストヘッダーを確認することでクライアント個別にIPアドレスを取得することができます

## 質問28
>あるベンチャー企業ではAWSを利用したCI/CD環境を整備しています。開発環境はCodePipelineを使用して、CodeCommitリポジトリ、AWS CodeBuild、およびAWS Elastic Beanstalkを利用してアプリケーションがデプロイされます。Elastic Beanstalk環境に使用されていない古いバージョンがたまっているようです。最適な実行環境を維持するために古いバージョンを削除して、アプリケーションの新しいバージョンを作成するように運用を自動化してください。

>この要件を達成するためのElastic Beanstalkのセットアップ方法を選択してください

*A: ライフサイクルポリシーを設定する*

***
note:

> AWS Elastic Beanstalkはライフサイクルポリシーを設定することができ、Elastic Beanstalkで使用されていない古いバージョンを削除して、アプリケーションの新しいバージョンを作成するといった対応が可能です。

>AWS Elastic Beanstalkでは新しいバージョンのアプリケーションをアップロードするたびに、Elastic Beanstalk はアプリケーションバージョンを作成します。使用しなくなったバージョンを削除しないと、最終的にはアプリケーションバージョン制限に到達し、そのアプリケーションの新しいバージョンを作成できなくなります。 Elastic Beanstalk のアプリケーションバージョンのライフサイクルポリシーを適用することで、制限に到達するのを回避できます。ライフサイクルポリシーにより、古いアプリケーションバージョンを削除するか、アプリケーションの合計数が指定した数を超えた場合にアプリケーションバージョンを削除するよう Elastic Beanstalkが実行されます。

## 質問29
>A社では開発環境などは全てDocker形式で展開できるようにAmazon ECSを使用してDockerアプリケーションを構築しています。あなたはFargate起動モードを使用してDockerコンテナに対してX-Rayデーモンを実行したいと考えています。 そのために、コンテナに対するX-Rayの最適な設定方法を調べることにしました。

>この要件を達成するためのセットアップ方法を選択してください。（2つ選択してください。）

*A: X-Rayデーモンエージェントをサイドカーコンテナとしてデプロイする*<br>
*X-RayにFargateを操作する適切なIAMロールを設定する*

***
note:

* デーモンに対してコンテナを立てる必要あり　サイドカーコンテナにUDP2000でアクセスする

>Amazon ECSやAmazon EKSによるFargate起動モードを使用したDockerコンテナに対してX-Rayデーモンを実行したい場合は、X-Rayデーモンエージェントをサイドカーコンテナとしてデプロイする必要があります。AWS X-Ray デーモンは、UDP ポート 2000 のトラフィックをリッスンし、未加工のセグメントデータを収集して AWS X-Ray API に中継するソフトウェアアプリケーションです。AWS Fargateを使用している場合は、基になるインスタンスを制御できないため、EC2インスタンスにエージェントをデプロイしたり、 デーモンセットとしてのX-Rayエージェントコンテナーに設定することが必要です。

* Fargate起動モードの場合はタスクにIAMロールのみが利用できるようになっている　ポリシーはそれの実態だから今回は違う

## 質問31
>あなたはEC2インスタンスベースのWEBアプリケーションに対して、Elastic Beanstalkを利用したバージョン更新を準備しています。繰り返しタスクやスケジュール設定されたタスクセットを非同期で実行する際に、Elastic Beanstalkを利用した効果的なデプロイ方法が必要です。

>繰り返しタスクを実行するには、どのようにElastic Beanstalk環境をセットアップする必要がありますか？

*A: ワーカー環境にcron.yamlファイルを設定する*

***
note:

* デプロイした時に必要なmigrationとかをするためにはcronで設定する

> ワーカー環境にcron.yamlファイルを設定することで、Elastic Beanstalkを利用して繰り返しタスクやスケジュール設定されたタスクセットを非同期で実行することができます。

>Elastic Beanstalkにより完了するまでに長い時間がかかるオペレーションまたはワークフローを実行する場合、それらのタスクを専用のワーカー環境にオフロードできます。ブロックオペレーションを実行するプロセスからウェブアプリケーションのフロントエンドを分離することは、アプリケーションに負荷がかかっていても応答性を保つための一般的な方法です。この設定には、 cronジョブを定義したcron.yamlファイルが必要です。

## 質問32
>あなたはAmazon SQSを利用した顧客からのリクエストを処理するアプリケーションを開発しています。Client_idごとにメッセージ順序が前後しないようにキューを処理するために、FIFOキューを選択しました。 アプリケーション障害の原因となるため、重複したメッセージがSQSに送信されないようにする必要があります。 

>メッセージを重複排除するには、どのメッセージパラメーターの値を設定する必要がありますか？

*A: メッセージ重複排除ID*

***
note:

* メッセージ重複排除 ID は 送信されたメッセージの重複排除に使用するトークン
* 特定のメッセージ重複排除 ID を持つメッセージが正常に送信された場合、同じメッセージ重複排除 ID を持つ送信メッセージは正常に受け付けられるが、5 分間の重複排除間隔の間は配信されない

>メッセージが受信された直後は、メッセージはキューに残ったままです。他のコンシューマーが同じメッセージを再び処理しないように、Amazon SQS は可視性タイムアウト（Visibility Timeout）を設定しています。この時間内では、他のコンシューマーによる同じメッセージの受信と処理が防止されます。メッセージのデフォルトの可視性タイムアウトは 30 秒です。最小値は 0 秒、最大スケールは 12 時間です。Visibility Timeoutはメッセージ重複を抑止する機能ですが、メッセージパラメーターではないため要件には合致していません。

## 質問33
>あるベンチャー企業ではAWSを利用したCI/CD環境を整備しています。これにはプロジェクトのCI/CD環境のニーズに対応するワンストップダッシュボードが必要です。各コンポーネントの個別の構成を厳密に制御する必要はありませんが、プロジェクトの全体像を把握できる必要があります。

>この要件を達成するため利用するべきAWSサービスはどれでしょうか？

*A: CodeStar*

***
note:

* ElasticBeanstalkも含んだ一撃でCI環境を作れるものがAWS CodeStar
* scaffold的なもの

>AWS CodeStar を使用すると、アプリケーションを迅速に開発および構築して AWS にデプロイできます。AWS CodeStar は統合されたユーザーインターフェイスを備えているため、ソフトウェア開発アクティビティを 1 つの場所で簡単に管理できます。AWS CodeStar では、継続的デリバリーのツールチェーン全体を数分で設定でき、コードのリリースをすばやく開始できます。AWS CodeStar によってチーム全体がセキュアに連携しやすくなり、プロジェクトのアクセス管理や所有者、コントリビューター、ビューワーの追加も簡単です。

>AWS CodeStar の各プロジェクトには、Atlassian JIRA Software による問題追跡機能が統合されたプロジェクト管理ダッシュボードが用意されています。このプロジェクトダッシュボードにより、作業項目のバックログからチームの最新のコードデプロイまで、ソフトウェア開発プロセス全体の進行状況を簡単に追跡できます。

## 質問34
>あなたはAWSを得意としたアプリケーション開発エンジニアです。現在は、AWSの一連のオンデマンドEC2インスタンス群でホストされるアプリケーションを開発しています。このアプリケーションの不具合のトレースと検証にはX-Rayを利用しています。

>X-Rayを使用する際の考慮事項として正しい内容を選択してください。（2つ選択してください。）

*A: サブセグメントを作成してAWSサービスとAWS SDKで作成するリソースへの呼び出しを記録することができる*<br>
*メタデータオブジェクトに、セグメントに保存する追加のカスタムデータを設定する*

***
note:

> X-Rayではサブセグメントを作成して、AWS のサービスと AWS SDK で作成するリソースへの呼び出し、内部または外部 HTTP ウェブ API への呼び出しや SQL データベースクエリの呼び出しを記録することができます。また、サブセグメントを作成してアプリケーションでコードブロックをデバッグしたり、注釈を付けたりできます。サブセグメントには他のサブセグメントを含めることができるため、内部関数呼び出しに関するメタデータを記録するカスタムサブセグメントには、他のカスタムサブセグメントおよびダウンストリーム呼び出し用のサブセグメントを含めることができます。

>セグメントとサブセグメントには、オブジェクトと配列を含む、任意の型の値を持つ 1 つ以上のフィールドが含まれた メタデータオブジェクトを含めることができ、セグメントに保存する追加のカスタムデータを設定することが可能です。X-Ray はメタデータのインデックスを作成せず、セグメントドキュメントが最大サイズ (64 kB) を超えない限り、値は任意のサイズにすることができます。BatchGetTracesAPI によって返された完全なセグメントドキュメントで、メタデータを表示できます。

## 質問36
>C社はAWS Lambda、API Gatewayで構成された新しいサーバーレスアーキテクチャを構築しています。あなたはエンジニアとして、ZIPファイルとして圧縮されたLambda関数のパッケージをAWSにデプロイしています。 ただし、パッケージが大きすぎるため、展開プロセスでエラーが発生します。 関数コードを使用して依存関係を減少させることで、エラーを回避することが必要です。

>この要件を達成するために最も適切なソリューションを選択してください。

*A: Lambdaレイヤーを利用してLambda関数の依存関係をアップロードする*

***
note:

* Lambdaレイヤーは複数のLambda関数でコードを共有するもの
* モジュールとして共通機能を取り込むためのZipの置き場　ライブラリとかを置いとけてデプロイには含まれないためデプロイする際に容量を小さくできる

>Lambdaレイヤーを利用してLambda関数の依存関係をアップロードすることでエラーを回避できます。Lambdaレイヤーによって、追加のコードとコンテンツをレイヤーの形式で取り込むように Lambda 関数を設定することができます。レイヤーは、ライブラリ、カスタムランタイム、またはその他の依存関係を含む ZIP アーカイブです。レイヤーを使用することで、関数のライブラリを使用することができます。これはデプロイパッケージに含める必要はありません。

>レイヤーを使用することでデプロイパッケージを小さくすることができるため、開発しやすくなります。これにより、関数コードを使用して依存関係をインストールしてパッケージ化するときに発生する可能性のあるエラーを回避することができます。Node.js、Python、Ruby 関数の場合は、デプロイパッケージを 3 MB に保管している場合を除き、Lambda コンソールで関数コードをデプロイすることができます。   

## 質問37
>A社では開発環境などは全てDocker形式で展開できるようにAmazon ECSを使用してアプリケーションを構築しています。現在、このDockerアプリケーションで、高レイテンシーの発生によって処理が止まったり再起動したりする問題が発生しています。 あなたは高レイテンシーが発生している場所を検出し、アプリケーションのパフォーマンスに影響を与える原因を特定する対応を行っているところです。

>このタスクのために最も適切なソリューションを選択してください。（2つ選択してください。）

*A: X-Rayデーモンを実行するDockerイメージを作成し、それをDockerイメージリポジトリにアップロードしてからECSクラスターにデプロイする*<br>
*タスク定義ファイルでポートマッピングとネットワークモード設定を構成して、UDPポート2000でのトラフィックを許可する*

***
note:

* 質問29参照
* 別でX-Ray用のコンテナを作りUDP2000でつなぐ！！！！！

>高レイテンシーが発生している場所を検出し、アプリケーションのパフォーマンスに影響を与えるサービスとパスを特定するためにはX-Rayを利用します。Amazon ECSでX-Rayを利用するためには、X-Rayデーモンを実行するDockerイメージを作成し、それをDockerイメージリポジトリにアップロードしてから、Amazon ECSクラスターにデプロイすることが求められます。また、ECS内の設定としては、タスク定義ファイルでポートマッピングとネットワークモード設定を構成して、UDPポート2000でのトラフィックを許可することが必要です。

>AWS X-Rayデーモンは、UDPポート2000でトラフィックをリッスンし、未加工のセグメントデータを収集して、AWS X-Ray APIに中継するソフトウェアアプリケーションです。 デーモンはAWS X-Ray SDKと連携して動作し、SDKによって送信されたデータがX-Rayサービスに到達できるように実行する必要があります。アプリケーションを適切に設定するための正しい手順は、X-Rayデーモンを実行するDockerイメージを作成し、それをDockerイメージリポジトリにアップロードしてから、Amazon ECSクラスターにデプロイすることです。さらに、タスク定義ファイルでポートマッピングとネットワークモード設定を構成して、UDPポート2000でのトラフィックを許可する必要もあります。
