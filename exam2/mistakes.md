##　質問1
>あなたはAWS専門のエンジニアとして、IoTデータをキャプチャしてAmazon Kinesis Data Streamsに送信するモバイルアプリケーションを構築しています。このアプリケーションは、EC2インスタンスを利用してKCLをインストールしてKinesisと連携しています。 カスタムメトリックに基づいて、インスタンスがCPU使用率を最大限に活用しており、Amazon Kinesis Data Streamsに流れるデータレートを処理するにはKinesisのシャードが不十分なようです。

>この問題を解決するためのソリューションを選択してください。（2つ選択してください。）

*A: 利用しているEC2インスタンスのインスタンスサイズを増強する,Kinesisシャードを分割する*

***
note:

* シャードは分けると処理が上がる、逆にマージして処理を下げる
* Kinesisのストリーム処理能力を高める場合は、インスタンスサイズを増強させる

>■リシャーディング
シャードの分割では１ つのシャードを 2 つシャードに分けます。シャードの結合では、2 つシャードを 1 つのシャードに組み合わせます。リシャーディングは、1 回のオペレーションでシャードに分割できる数と 1 回のオペレーションで結合できるシャードの数が 2 個以下に限られるという意味で、常にペアワイズです。リシャーディングオペレーションの対象となるシャードまたはシャードペアは、親シャードと呼ばれます。リシャーディングオペレーションを実行した結果のシャードまたはシャードペアは、子シャードと呼ばれます。 分割によりストリーム内のシャードの数が増えストリームのデータ容量は増えます。シャード単位で請求されるため、分割によりストリームのコストが増えます。

>■シャードに合わせたインスタンスサイズの増強
Kinesisストリーム内のインスタンスのサイズとシャードの数を増やすことで、インスタンスがインスタンス内で並行して実行されるより多くのレコードプロセッサを処理できるようにします。 また、ストリームが送信されるデータのレートに適切に対応できるようにします。ストリームのデータ容量は、ストリームに指定するシャードの数の関数です。

## 質問2
>Fintech企業A社はビットコインなどの暗号通貨を売買できる仮想通貨取引プラットフォーム事業を開始しました。金融サービスとなるため高いコンプライアンス要件が仮想通貨取引所には求められており、厳格なIT監査を受ける必要があります。 あなたは監査に向けて、KMSの機能として暗号化を進めるように求められています。

>AWS KMSの暗号化プロセスの説明として合致してる内容はどれでしょうか？（2つ選択してください。
）

*A: KMSは毎回キーを回転させることができる,KMSはKMSに保存されているマスターキーを使用して暗号化する*

***
note:

* AWS KMS のカスタマーマスターキー (CMK) の新しい暗号化マテリアルを作成するために、新しい CMK を作成した後、アプリケーションまたはエイリアスを変更して新しい CMK を使用できる
または、既存の CMK の自動キーローテーションを有効にすることもできる
* マスターキーを元に暗号化するかマスターキーを回転して新たに暗号キーを作成できる

>■データの暗号化、復号、再暗号化 プレーンテキストでサービスからエクスポートできるデータ暗号化キー、またはサービスから持ち出せないマスターキーで暗号化されたデータ暗号化キーを生成します。

>■暗号化アプリケーションに適したランダムな数値を生成します。AWS KMS を使用することで、暗号化するデータへのアクセスをより詳細に制御できます。キー管理および暗号化機能を直接アプリケーションで使用するか、AWS KMS と統合される AWS サービスを通じて使用できます。AWS のアプリケーションを作成しているか、AWS サービスを使用しているかにかかわらず、AWS KMS ではマスターキーを使用できるユーザー、暗号化されたデータにアクセスできるユーザーを制御できます。

## 質問3
>あなたはソリューションアーキテクトとして、ヘルステックベンチャーにおいてAWSでホストされた健康管理アプリケーションの開発を行っています。このアプリケーションはCloudFormationスタックを利用してグローバルにインフラが展開されています。現在のスタック構成は以下の通りです。

>■東京リージョンにスタック「Health1」を作成：Outputに「NewStack」を出力<br>
>■シンガポールリージョンにスタック「Health2」を作成：Outputに「NewStack」を出力

>シンガポールリージョンにスタック「Health1」をデプロイしたところ、エラーが発生しました。その原因は何でしょうか？

*A: AWSアカウントごとに、エクスポート名はリージョン内で一意である必要があるため、エクスポート名を変更する必要がある。*

***
note:

* CloudFormationではAWSアカウントごとに、エクスポート名はリージョン内で一意である必要がある(同一アカウント、同一リージョン内では同じエクスポート名はだめ！)

>次のような制限がクロススタックの参照に適用されます 

>・各AWS アカウントの場合は、エクスポート名はリージョン内で一意である必要があります。<br>
>・リージョンにわたるクロススタックの参照を作成することはできません。同じリージョンFn::ImportValue内では、エクスポートされた値のみインポートするのに組み込み関数を使用できます。<br>
>・出力はName プロパティ (Export に属す) の値で、リソースに依存する Ref または GetAtt 関数を使うことはできません。<br>
>・同様に、ImportValue 関数にリソースに依存する Ref または GetAtt 関数を含むことはできません。<br>
>・他のスタックから参照されている出力が存在する場合は、スタックを削除することはできません。<br>
>・別のスタックで参照した出力値を変更したり削除することはできません。

## 質問6
>あなたの会社はEC2インスタンスのAuto ScalingグループとALBで構成されるWebアプリケーションを利用しています。さらにデフォルトのドメイン名を持つCloudFrontを使用してコンテンツを配信しています。さらに、安全な通信を確立するためにビューアとCloudFront間のHTTPS通信を設定することになりました。

>この要件を満たすためにCloudFrontで実施するべき設定は何でしょうか？（2つ選択してくさい。）

*A: CloudFrontのビューアプロトコルポリシーにRedirect HTTP to HTTPSを設定する,<br>CloudFrontのビューアプロトコルポリシーにHTTPS Onlyを設定する*

***
note:

* 開発者としてビューアとCloudFront間のHTTPS通信を設定するためには、<br>
「Redirect HTTP to HTTPS」または「HTTPS Only」を使用するようにビューアプロトコルポリシーを設定することが必要
* ビューアがHTTPできたらHTTPSで返すのとHTTPSでしかアクセスできないようにする

>CloudFrontがディストリビューションに割り当てたドメイン名を使用している場合、1つ以上のキャッシュ動作のビューアープロトコルポリシー設定を変更して、 Redirect HTTP to HTTPSまたはHTTPS Onlyを設定することでHTTPS通信を要求できます。オリジンがELBロードバランサーの場合、AWS Certificate Manager（ACM）が提供する証明書を使用できます。

## 質問7
>A社では開発環境などは全てDocker形式で展開できるようにECSを使用した新アプリケーションを構築しています。このアプリケーションでは、ポートマッピングを使用してネットワークトラフィックを送受信できるように コンテナの設定が必要です。

>このタスクを適切に実装するためには、どのECS機能を設定する必要がありますか？

*A: タスク定義*

***
note:

* Dockerコンテナーがポートマッピングを使用してネットワークトラフィックを送受信できるようにするためには、Amazon ECSにおいてタスク定義を設定する
* コンテナエージェントはコンテナインスタンスがクラスタに接続することのみを許可するためのもの

> Amazon ECS で Docker コンテナを実行するためにタスク定義が必要です。<br>
タスク定義は、タスクファミリー、IAM タスクロール、ネットワークモード、コンテナ定義、ボリューム、タスク配置の制約事項、起動タイプの各部分に分かれています。ファミリーとコンテナ定義はタスク定義に必須ですが、タスクロール、ネットワークモード、ボリューム、タスク配置の制約事項、起動タイプはオプションです。

## 質問8
>あなたはサーバレスを得意とした開発者としてA社に勤務しています。現在は、CloudFormationを使用して、API GatewayからLambdaを呼び出して、DynamoDBへとデータを記録・取得するサーバーレスアプリケーションをデプロイしています。 その際に、AWS SAM構文において、SAMバージョンを指定する必要があるテンプレートでリソースを宣言することが必要です。

>CloudFormationテンプレートにおいて、リソースセクション以外に設定するべき内容を選択してください。（2つ選択してください。）

*A: AWS::ServerlessにAWS SAMのバージョンを指定する,AWS::ServerlessオプションのTransformを設定する*

***
note:

* Lambdaなのでサーバーレスの設定を選ぶ問題
* AWS::Serverless Transformの設定でSAMのバージョンを指定する必要がある
* AWS SAMを利用してサーバーレスアプリケーションをCloudFormationで展開する

## 質問11
>あなたが開発したサーバーレスアプリケーションは、複数のAPI Gatewayを利用してアプリケーションのリリースライフサイクルごとにLambdaを呼び出して、ユーザーから送信されたアドホックリクエストを処理します。このアプリのリリースは他のアプリケーションへの影響を考慮しながら段階的に実施されます。要件としては、リリース段階に応じて、異なるバックエンドのエンドポイントとやり取りを変更することが求められています。

>段階的なリリースを実現するための設定方法を選択してください

*A: 各リリースにおいてステージ変数を設定する*

***
note:

* 各サーバーレスAPIはデプロイ先としてステージをもち、それぞれ異なるバージョンのAPIを公開できる

>ステージ変数は、REST API のデプロイステージと関連付けられた設定属性として定義できる名前と値のペアです。環境変数と同様に機能し、API のセットアップやマッピングテンプレートで使用できます。 各リリースにおいてステージ変数を設定することで、リリースの段階を管理することができます。API Gateway のデプロイステージでは、アルファ、ベータ、プロダクションなど、各 API 用の複数のリリースステージを管理できます。ステージ変数を使用することで、異なるバックエンドのエンドポイントとやり取りするよう API デプロイステージを設定できます

## 質問12
>あなたはAWSを利用してサーバレスアプリケーションを構築している開発者です。 Lambdaプロキシ統合を使用してLambda関数とAPI Gatewayを統合した新しいアプリケーションを構築しました。しかしながら、呼び出しURLを使用してAPI Gatewayを呼び出すと、接続拒否エラーが発生します。

>この問題の最も可能性の高い原因はどれでしょうか？

*A: APIを呼び出す際にHTTPSエンドポイントを利用していない*

***
note:

* API Gatewayはサーバーレスの完全マネージドサービスで,Lambda等を使ってRESTfulなAPIやWebsocketAPIを完全サーバーレスで実現することができる
* Amazon API Gateway で作成された API はすべて、HTTPS エンドポイントのみ公開される

## 質問13
>開発者はAWS上でWEBアプリケーションを構築しました。このアプリケーションのバグ修正やパフォーマンス最適化のためにAWS X-Rayを使用して、実行中のWebアプリケーションをトレースする必要があります。アプリケーションによって送信されるセグメントドキュメントには、特定のデータを識別するときに利用する「Annotation(注釈)」があり、これを利用して適切なセグメント検索やトレースを実施することが必要です。

>適切なセグメント検索やトレースを実施するために、AWS X-Rayの適切な設定方法を選択してください。（2つ選択してください。）

*A: X-Rayコンソールにおいてフィルタ式を選択する,<br>GetTraceSummariesAPIを使用して、特定の情報に関連づけられたセグメントを検索する*

***
note:

* AWS X-Rayではフィルタ式を使用して検索するトレースだけに結果を絞り込むことができ、X-RayコンソールまたはGetTraceSummaries APIを使用して、特定の情報に関連付けられたセグメントを検索できる

>フィルタ式は、特定のサービスノードまたはエッジにヒットするエラーや、既知のユーザーからのトレースされた要求をターゲットにできます。 たとえば、次のフィルター式は、api.example.comを通過するトレースを対象としています。 

>service（ "api.example.com"） 

>このフィルター式は、値が12345のaccountという名前の注釈を持つトレースを検索します。

>annotation.account = "12345"

>GetTraceSummariesはフィルタ式を使用して、指定された時間枠で使用可能なトレースのIDと注釈を取得します。 完全なトレースを取得するには、BatchGetTracesにトレースIDを渡します。

## 質問17
>あなたはアプリ開発・導入担当として、Elastic Beanstalkを利用したWEBアプリケーションをデプロイしています。定期的なタスクとしてElastic BeanstalkによってWEBアプリケーションのバージョン更新を実施していますが、その際にインプレース更新を実行しており、その間はアプリケーションを使用できなくなります。あなたは一時的なアプリケーションが利用不可となる現状を回避するため、DNSスイッチを使用してトラフィックを新しいバージョンにリダイレクトする構成を設定しています。

>この要件を達成するためのAWS Elastic Beanstalkの展開方式を選択してください。

*A: Blue-Green Deployment*

***
note:

* DNSスイッチを使用してトラフィックを新しいバージョンにリダイレクトする設定というのがミソ

>アプリケーションのバージョンを更新するときに AWS Elastic Beanstalk がインプレース更新を実行するため、アプリケーションはわずかな期間、ユーザーに利用不可になることがあります。その際にBlue-Green Deployment を実行することで、このダウンタイムを回避できます。この場合、個別の環境に新しいバージョンをデプロイしてから、2 つの環境の CNAME を入れ替えて、すぐに新しいバージョンにトラフィックをリダイレクトします。

>Blue-Green Deployment では、アプリケーションがプロダクションデータベースを使用する場合、ユーザーの環境がそのデータベースから独立して実行される必要があります。ユーザーの環境に Amazon RDS DB インスタンスがアタッチされている場合、データはもう一方の環境に転送されず、元の環境が終了した場合に失われます。 

## 質問18
>A社ではアプリケーション展開と連携のためにAPIを多数利用しています。現在、あなたはアプリケーションを使用してテキストメッセージを送受信できるような機能開発を実施しているところです。 REST APIを利用して、高可用性とスケーラビリティを実現する実装が必要です。

>AWSにおいてREST APIの実装に使用できるサービスの組み合わせを選択してください。（2つ選択してください。）

*A: API Gateway + Lambda, ALB + ECS*

***
note:

* API Gateway + LambdaでスケーラブルなRESTfulなAPIを提供できるというのは質問12の通り
* ECSもDockerコンテナー管理プラットフォームであり、ALBなどのロードバランサーと併用すると、スケーラブルで負荷分散されたREST APIを提供できる

## 質問19
>ある会社ではユーザー設定情報などのデータ管理にDynamoDBを利用しています。あなたはデータベース開発者として、DynamoDBを使用してデータ読込処理を実装しています。その際には、いくつかの属性を部分的に取得することで効率的なデータ処理を実現する必要があります。 

>どのようにDynamoDBの設定をする必要がありますか？

*A: ProjectionExpressionを利用する*

***
note:

* query メソッド内で設定するProjectionExpressionは必要な属性を識別する文字列
* いくつかの属性を部分的に取得することで効率的なデータ処理を実現する=>ProjectionExpression!!

>DynamoDBではquery メソッドを使用して、テーブルからデータを取得できます。このためにはパーティションキーの値を指定する必要があります。 query メソッド内で設定するProjectionExpressionは必要な属性を識別する文字列です。これによって、属性を限定したデータ取得を実行することができます。 単一の属性を取得するには、名前を指定します。 複数の属性の場合、名前はコンマで区切る必要があります。

>Scan メソッドはテーブル全体のすべての項目を読み込み、テーブルの全データを返します。オプションで filter_expression を提供して、条件に一致する項目だけが返されるように指定できます。ただし、テーブル全体がスキャンされた後にのみ、フィルタが適用されます。この設定は本件の内容では利用しないため正しくありません。

## 質問23
>A社ではアプリケーション開発においてAWS CodeCommitとAWS CodeDeployなどを利用して開発・テスト・デプロイまでのパイプラインを利用したCI/CD環境を整備しています。あなたはデプロイ担当者として、AWS CodePipelineを使用して、AWSマネジメントコンソールから新しいパイプラインを作成しました。 プロセスは、GitHubにコミットされたコード変更をプルして、AWS CodeBuildでビルドを生成し、AWS Elastic Beanstalk環境にデプロイされるように構成されています。このCodePipelineを実行したところ、ターゲットとなるElastic Beanstalk環境と連携できないエラーが発生しました。

>CodePipelineの実行エラーの原因を見つけるために、どのような手順をとるべきでしょうか（3つ選択してください。）

*A: CloudFormationで原因を探索する,*<br>
*IAM Policy Simulatorで原因を探索する,*<br>
*CloudTrailで原因を探索する*<br>

***
note:

>Elastic Beanstalkの削除をCloudFormationで検索することで、原因を探索することができます。Elastic BeanstalkはCloudFormationによってサポートされているため、CloudFormationでバッキングスタックが表示されない場合、それがBeanstalk環境が削除された理由であることを意味します。

>対象のElastic Beanstalk環境と連携できずに実行エラーが発生しており、認証関連のトラブルが予測されます。そのため、認証関連のイベントや設定エラーをIAM Policy Simulatorを利用して検索します。IAM Policy Simulator では IAM およびリソースベースのポリシーをテストし、トラブルシューティングできます。 Policy Simulator は、選択されたポリシーを評価し、指定された各アクションに対して有効なアクセス許可を特定します。このシミュレーターでは、AWS のサービスに対する実際のリクエストで使用されるものと同じポリシー評価エンジンが使用されます。

>Elastic Beanstalk関連のイベントをCloudTrailで検索して原因を探索します。CloudTrail を使用すると、AWS インフラストラクチャ全体でアカウントアクティビティをログに記録し、継続的に監視し、保持できます。CloudTrail では、AWS マネジメントコンソール、AWS の SDK やコマンドラインツール、その他の AWS のサービスを使用して実行されるアクションなど、AWS アカウントアクティビティのイベント履歴を把握できます。 

## 質問24
>B社では現在、多くのユーザーに利用される予定のWEBアプリケーション開発を実施しており、あなたはAmazon Kinesis Data Streamsのデータ処理を担当しており、現在はAPI Gatewayと連携したAWS Lambdaを使用して、Kinesisによりデータ取得処理を開発しています。これらのデータはWebサイトをナビゲートするユーザーからのクリックストリームです。データボリュームの増加に応じて、Amazon Kinesis Data Streamsが時間とともにスケール可能とする設定を依頼されました。

>この要件を満たすためには、どのアクションを実行することが必要となりますか？（2つ選択してください。）

*A: シャードを追加する,パーティションキーに多数の異なる値が必要となる*

***
note:

* Kinesis Data Streamsにはオートスケーリングはない！シャードを分割する！
* ボリュームの増加によりKinesis Data Streamsが時間とともにスケール可能とするためには、パーティションキーに多数の異なる値が必要 
* パーティションキーは、ストリーム内のデータをシャード別にグループ化するため
* ストリームの保持期間は、デフォルトで作成後 24 時間

## 質問25
>ある会社ではAWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成した新しいサーバーレスアーキテクチャを実装しています。 あなたは担当エンジニアとして、いくつかのAWS Lambda関数を起動しましたが、 1MBを超えるデータを関数に渡し、実行時に暗号化および復号化する必要があるという新しい要件が与えられました。

>このデータ暗号化の要件に適した方法を選択してください。

*A: 暗号化SDKを使用して、暗号化されたファイルをLambda関数でエンベロープして保存する*

***
note:

* AWS Lambda環境変数の最大サイズは512KBで、AWS KMSの「暗号化」APIには数KBの制限があります。 1 MBを暗号化するには、暗号化SDKを使用して、暗号化されたファイルをLambda関数でエンベロープする必要があります

* Lambdaで暗号化するにはKMSのキーと暗号化ヘルパーを使うがそれは512KBまで
* だから暗号化SDKを使ってLambda側で展開する

> AWS Lambda関数上のデータを暗号化するためには、環境変数を使用して、シークレットを安全に保存して Lambda 関数で使用できます。Lambda は保管状態の環境変数を常に暗号化します。さらに、以下の機能を使用して、環境変数がどのように暗号化されるかをカスタマイズできます。

>■キー設定
関数ごとに Lambda を設定して、AWS Key Management Service で作成し、管理する暗号化キーを使用できます。これらは、カスタマー管理のカスタマーマスターキー (CMK) またはカスタマー管理型のキーと呼ばれます。カスタマー管理型のキーを設定しない場合、Lambda は、Lambda がアカウントで作成する、aws/lambda という名前の AWS 管理型 CMK を使用します。 

>■暗号化ヘルパー
Lambda コンソールを使用すると、環境変数の値を Lambda に送信する前に、クライアント側で暗号化できます。これにより、Lambda コンソール、または Lambda API に返される関数の設定で、シークレットが暗号化されずに表示されることを防止できるため、セキュリティがさらに強化されます。また、コンソールでは、関数ハンドラーの値を復号化するために調整できるサンプルコードも利用できます。 
しかしながら、AWS Lambda環境変数の最大サイズは512KBで、AWS KMSの「暗号化」APIには数KBの制限があるため、上記の標準的な暗号化手段だけでは１MBのデータ暗号化は実現不可能です。 したがって、1 MBを暗号化するには、暗号化SDKを使用して、暗号化されたファイルをLambda関数でエンベロープする必要があります。

## 質問26
>B社ではAWSを利用したアプリケーション開発を行っています。開発者向けにはAWSサービスへのアクセスを許可するアクセスキーとシークレットアクセスキーを持つIAMユーザーアカウントを提供しました。開発者から開発環境においてCodeBuildのビルド実行が失敗するという報告があがりました。しかしながら、適切なメトリクスが取得できておらず原因が特定できないようです。そこで、CodeBuildのビルド実行エラーを確認するための設定を行います。

>失敗したビルドのログを確認する方法を選択してください。（2つ選択してください。）

*A: CloudTrail,S3とCloudWatch統合を有効にする*

***
note:

* CloudTrailを有効化することで AWS CodeBuildのログを取得することができる
* S3とCloudWatchの統合を有効にすることで、CodeBuildによってS3にアップロードされた実行データへのログを確認することができる

> CodeBuildはビルド出力がある場合、その出力データをAmazon S3バケットにアップロードします。 ビルドの実行中に、AWS CodeBuildコンソール、AWS CLI、またはAWS SDKを使用して、AWS CodeBuildから要約ビルド情報を取得し、Amazon CloudWatch Logsから詳細なビルド情報を取得できます。

## 質問27
>B社ではAWSを利用したアプリケーション開発を行っています。このアプリケーションはALBを設定した複数のEC2インスタンスで構成されています。要求を行っているクライアントのIPアドレスを取得し、そのIPアドレスに返答する処理が必要となりますが、テストしてみると、ALBのIPアドレスばかりが取得されているようです。

>クライアント固有のIPアドレスを取得する方法を選択してください。

*A: バックエンドのX-Forwarded-Forヘッダーを確認する*

***
note:

> ELBはクライアントの IP アドレスを X-Forwarded-For リクエストヘッダーに格納し、このヘッダーをサーバーに渡します。 したがって、 X-Forwarded-For リクエストヘッダーを確認することでクライアント個別にIPアドレスを取得することができます

## 質問28
>あるベンチャー企業ではAWSを利用したCI/CD環境を整備しています。開発環境はCodePipelineを使用して、CodeCommitリポジトリ、AWS CodeBuild、およびAWS Elastic Beanstalkを利用してアプリケーションがデプロイされます。Elastic Beanstalk環境に使用されていない古いバージョンがたまっているようです。最適な実行環境を維持するために古いバージョンを削除して、アプリケーションの新しいバージョンを作成するように運用を自動化してください。

>この要件を達成するためのElastic Beanstalkのセットアップ方法を選択してください

*A: ライフサイクルポリシーを設定する*

***
note:

> AWS Elastic Beanstalkはライフサイクルポリシーを設定することができ、Elastic Beanstalkで使用されていない古いバージョンを削除して、アプリケーションの新しいバージョンを作成するといった対応が可能です。

>AWS Elastic Beanstalkでは新しいバージョンのアプリケーションをアップロードするたびに、Elastic Beanstalk はアプリケーションバージョンを作成します。使用しなくなったバージョンを削除しないと、最終的にはアプリケーションバージョン制限に到達し、そのアプリケーションの新しいバージョンを作成できなくなります。 Elastic Beanstalk のアプリケーションバージョンのライフサイクルポリシーを適用することで、制限に到達するのを回避できます。ライフサイクルポリシーにより、古いアプリケーションバージョンを削除するか、アプリケーションの合計数が指定した数を超えた場合にアプリケーションバージョンを削除するよう Elastic Beanstalkが実行されます。

## 質問29
>A社では開発環境などは全てDocker形式で展開できるようにAmazon ECSを使用してDockerアプリケーションを構築しています。あなたはFargate起動モードを使用してDockerコンテナに対してX-Rayデーモンを実行したいと考えています。 そのために、コンテナに対するX-Rayの最適な設定方法を調べることにしました。

>この要件を達成するためのセットアップ方法を選択してください。（2つ選択してください。）

*A: X-Rayデーモンエージェントをサイドカーコンテナとしてデプロイする*<br>
*X-RayにFargateを操作する適切なIAMロールを設定する*

***
note:

* デーモンに対してコンテナを立てる必要あり　サイドカーコンテナにUDP2000でアクセスする

>Amazon ECSやAmazon EKSによるFargate起動モードを使用したDockerコンテナに対してX-Rayデーモンを実行したい場合は、X-Rayデーモンエージェントをサイドカーコンテナとしてデプロイする必要があります。AWS X-Ray デーモンは、UDP ポート 2000 のトラフィックをリッスンし、未加工のセグメントデータを収集して AWS X-Ray API に中継するソフトウェアアプリケーションです。AWS Fargateを使用している場合は、基になるインスタンスを制御できないため、EC2インスタンスにエージェントをデプロイしたり、 デーモンセットとしてのX-Rayエージェントコンテナーに設定することが必要です。

* Fargate起動モードの場合はタスクにIAMロールのみが利用できるようになっている　ポリシーはそれの実態だから今回は違う

## 質問31
>あなたはEC2インスタンスベースのWEBアプリケーションに対して、Elastic Beanstalkを利用したバージョン更新を準備しています。繰り返しタスクやスケジュール設定されたタスクセットを非同期で実行する際に、Elastic Beanstalkを利用した効果的なデプロイ方法が必要です。

>繰り返しタスクを実行するには、どのようにElastic Beanstalk環境をセットアップする必要がありますか？

*A: ワーカー環境にcron.yamlファイルを設定する*

***
note:

* デプロイした時に必要なmigrationとかをするためにはcronで設定する

> ワーカー環境にcron.yamlファイルを設定することで、Elastic Beanstalkを利用して繰り返しタスクやスケジュール設定されたタスクセットを非同期で実行することができます。

>Elastic Beanstalkにより完了するまでに長い時間がかかるオペレーションまたはワークフローを実行する場合、それらのタスクを専用のワーカー環境にオフロードできます。ブロックオペレーションを実行するプロセスからウェブアプリケーションのフロントエンドを分離することは、アプリケーションに負荷がかかっていても応答性を保つための一般的な方法です。この設定には、 cronジョブを定義したcron.yamlファイルが必要です。

## 質問32
>あなたはAmazon SQSを利用した顧客からのリクエストを処理するアプリケーションを開発しています。Client_idごとにメッセージ順序が前後しないようにキューを処理するために、FIFOキューを選択しました。 アプリケーション障害の原因となるため、重複したメッセージがSQSに送信されないようにする必要があります。 

>メッセージを重複排除するには、どのメッセージパラメーターの値を設定する必要がありますか？

*A: メッセージ重複排除ID*

***
note:

* メッセージ重複排除 ID は 送信されたメッセージの重複排除に使用するトークン
* 特定のメッセージ重複排除 ID を持つメッセージが正常に送信された場合、同じメッセージ重複排除 ID を持つ送信メッセージは正常に受け付けられるが、5 分間の重複排除間隔の間は配信されない

>メッセージが受信された直後は、メッセージはキューに残ったままです。他のコンシューマーが同じメッセージを再び処理しないように、Amazon SQS は可視性タイムアウト（Visibility Timeout）を設定しています。この時間内では、他のコンシューマーによる同じメッセージの受信と処理が防止されます。メッセージのデフォルトの可視性タイムアウトは 30 秒です。最小値は 0 秒、最大スケールは 12 時間です。Visibility Timeoutはメッセージ重複を抑止する機能ですが、メッセージパラメーターではないため要件には合致していません。

## 質問33
>あるベンチャー企業ではAWSを利用したCI/CD環境を整備しています。これにはプロジェクトのCI/CD環境のニーズに対応するワンストップダッシュボードが必要です。各コンポーネントの個別の構成を厳密に制御する必要はありませんが、プロジェクトの全体像を把握できる必要があります。

>この要件を達成するため利用するべきAWSサービスはどれでしょうか？

*A: CodeStar*

***
note:

* ElasticBeanstalkも含んだ一撃でCI環境を作れるものがAWS CodeStar
* scaffold的なもの

>AWS CodeStar を使用すると、アプリケーションを迅速に開発および構築して AWS にデプロイできます。AWS CodeStar は統合されたユーザーインターフェイスを備えているため、ソフトウェア開発アクティビティを 1 つの場所で簡単に管理できます。AWS CodeStar では、継続的デリバリーのツールチェーン全体を数分で設定でき、コードのリリースをすばやく開始できます。AWS CodeStar によってチーム全体がセキュアに連携しやすくなり、プロジェクトのアクセス管理や所有者、コントリビューター、ビューワーの追加も簡単です。

>AWS CodeStar の各プロジェクトには、Atlassian JIRA Software による問題追跡機能が統合されたプロジェクト管理ダッシュボードが用意されています。このプロジェクトダッシュボードにより、作業項目のバックログからチームの最新のコードデプロイまで、ソフトウェア開発プロセス全体の進行状況を簡単に追跡できます。

## 質問34
>あなたはAWSを得意としたアプリケーション開発エンジニアです。現在は、AWSの一連のオンデマンドEC2インスタンス群でホストされるアプリケーションを開発しています。このアプリケーションの不具合のトレースと検証にはX-Rayを利用しています。

>X-Rayを使用する際の考慮事項として正しい内容を選択してください。（2つ選択してください。）

*A: サブセグメントを作成してAWSサービスとAWS SDKで作成するリソースへの呼び出しを記録することができる*<br>
*メタデータオブジェクトに、セグメントに保存する追加のカスタムデータを設定する*

***
note:

> X-Rayではサブセグメントを作成して、AWS のサービスと AWS SDK で作成するリソースへの呼び出し、内部または外部 HTTP ウェブ API への呼び出しや SQL データベースクエリの呼び出しを記録することができます。また、サブセグメントを作成してアプリケーションでコードブロックをデバッグしたり、注釈を付けたりできます。サブセグメントには他のサブセグメントを含めることができるため、内部関数呼び出しに関するメタデータを記録するカスタムサブセグメントには、他のカスタムサブセグメントおよびダウンストリーム呼び出し用のサブセグメントを含めることができます。

>セグメントとサブセグメントには、オブジェクトと配列を含む、任意の型の値を持つ 1 つ以上のフィールドが含まれた メタデータオブジェクトを含めることができ、セグメントに保存する追加のカスタムデータを設定することが可能です。X-Ray はメタデータのインデックスを作成せず、セグメントドキュメントが最大サイズ (64 kB) を超えない限り、値は任意のサイズにすることができます。BatchGetTracesAPI によって返された完全なセグメントドキュメントで、メタデータを表示できます。

## 質問36
>C社はAWS Lambda、API Gatewayで構成された新しいサーバーレスアーキテクチャを構築しています。あなたはエンジニアとして、ZIPファイルとして圧縮されたLambda関数のパッケージをAWSにデプロイしています。 ただし、パッケージが大きすぎるため、展開プロセスでエラーが発生します。 関数コードを使用して依存関係を減少させることで、エラーを回避することが必要です。

>この要件を達成するために最も適切なソリューションを選択してください。

*A: Lambdaレイヤーを利用してLambda関数の依存関係をアップロードする*

***
note:

* Lambdaレイヤーは複数のLambda関数でコードを共有するもの
* モジュールとして共通機能を取り込むためのZipの置き場　ライブラリとかを置いとけてデプロイには含まれないためデプロイする際に容量を小さくできる

>Lambdaレイヤーを利用してLambda関数の依存関係をアップロードすることでエラーを回避できます。Lambdaレイヤーによって、追加のコードとコンテンツをレイヤーの形式で取り込むように Lambda 関数を設定することができます。レイヤーは、ライブラリ、カスタムランタイム、またはその他の依存関係を含む ZIP アーカイブです。レイヤーを使用することで、関数のライブラリを使用することができます。これはデプロイパッケージに含める必要はありません。

>レイヤーを使用することでデプロイパッケージを小さくすることができるため、開発しやすくなります。これにより、関数コードを使用して依存関係をインストールしてパッケージ化するときに発生する可能性のあるエラーを回避することができます。Node.js、Python、Ruby 関数の場合は、デプロイパッケージを 3 MB に保管している場合を除き、Lambda コンソールで関数コードをデプロイすることができます。   

## 質問37
>A社では開発環境などは全てDocker形式で展開できるようにAmazon ECSを使用してアプリケーションを構築しています。現在、このDockerアプリケーションで、高レイテンシーの発生によって処理が止まったり再起動したりする問題が発生しています。 あなたは高レイテンシーが発生している場所を検出し、アプリケーションのパフォーマンスに影響を与える原因を特定する対応を行っているところです。

>このタスクのために最も適切なソリューションを選択してください。（2つ選択してください。）

*A: X-Rayデーモンを実行するDockerイメージを作成し、それをDockerイメージリポジトリにアップロードしてからECSクラスターにデプロイする*<br>
*タスク定義ファイルでポートマッピングとネットワークモード設定を構成して、UDPポート2000でのトラフィックを許可する*

***
note:

* 質問29参照
* 別でX-Ray用のコンテナを作りUDP2000でつなぐ！！！！！

>高レイテンシーが発生している場所を検出し、アプリケーションのパフォーマンスに影響を与えるサービスとパスを特定するためにはX-Rayを利用します。Amazon ECSでX-Rayを利用するためには、X-Rayデーモンを実行するDockerイメージを作成し、それをDockerイメージリポジトリにアップロードしてから、Amazon ECSクラスターにデプロイすることが求められます。また、ECS内の設定としては、タスク定義ファイルでポートマッピングとネットワークモード設定を構成して、UDPポート2000でのトラフィックを許可することが必要です。

>AWS X-Rayデーモンは、UDPポート2000でトラフィックをリッスンし、未加工のセグメントデータを収集して、AWS X-Ray APIに中継するソフトウェアアプリケーションです。 デーモンはAWS X-Ray SDKと連携して動作し、SDKによって送信されたデータがX-Rayサービスに到達できるように実行する必要があります。アプリケーションを適切に設定するための正しい手順は、X-Rayデーモンを実行するDockerイメージを作成し、それをDockerイメージリポジトリにアップロードしてから、Amazon ECSクラスターにデプロイすることです。さらに、タスク定義ファイルでポートマッピングとネットワークモード設定を構成して、UDPポート2000でのトラフィックを許可する必要もあります。


## 質問42
>開発者はLambda関数とDynamoDBを連携させたモバイルアプリケーションを開発しています。要件は、Lambda関数のアプリケーション処理としてリクエストを非同期に処理することです。

>これを達成するための最も適切な方法は次のうちどれですか？

*A: InvokeAPIを使用してLambda関数を呼び出し、InvocationTypeをEventに設定する*

***
note:

* Lambda関数を実行(Invoke)するときにInvocationTypeを指定することができる
* InvocationTypeは3種類で、Event、RequestResponse、DryRunを指定することができ、デフォルトはRequestResponse

* Event
>InvocationTypeにEventを指定すると非同期実行になります。非同期呼び出しでは、Lambda関数が直接実行されるのではなく、キューイングされたのち実行されます。 キューイングされるためEventタイプでInvoke APIを実行すると、API実行後にすぐにレスポンスが返りステータスコードは202となります。(例えば関数が1分かかっても、処理完了を待たずに応答が返ります)
Lambda関数自体は、キューから実行されます。呼び出しに失敗した場合は自動的に2回リトライが実施されます。（初回起動を含めると最大3回実行）
実行が3回失敗したあと、イベントは破棄されますが、デッドレターキュー (DLQ) を指定した場合はSQSやSNSに送信することができます。例えば、失敗時にメールで送信するや、SQSキューに入れることで1日後にバッチで実行など対応できるようになります。

* RequestResponse
>RequestResponseを指定すると同期実行になります。キューイングされず実行されます。AWS側でのリトライ処理はなく実行は1回となります。RequestResponseタイプでInvoke APIを実行すると、関数が実行され、処理完了後にレスポンスが返ります。正常時のステータスコードは200となります。
同期であっても、エラー時のリトライは、呼び出し元(SDK)とかで リトライ走った場合の考慮は必要な筈。
ステータスコード429が返ってきた場合は、アプリ側で再試行の処理が必要になります。ただしAWS SDKを利用する場合はリトライが実装されています。
Lambda 関数を直接 (AWS SDK 経由または API Gateway 経由で)、呼び出した場合、クライアントではエラーが表示され再試行を選択できます。API ゲートウェイ を通じて Lambda を呼び出す場合は、Lambda の応答エラーを API ゲートウェイ のエラーコードに必ずマップする必要があります。

* DryRun
今回のリトライの話からそれますが、InvocationTypeにはDryRunを指定できます。 DryRunを指定すると関数を実行せずに必要な権限がついているかを確認できます。これは、クロスアカウントでの実行時の権限確認などできます。

## 質問44
>現在設計しているインフラアーキテクチャででは、リソースの供給と需要を適切に一致させることが可能な、拡張性の高いアーキテクチャが求められています。このインフラ構成には１つのデータベースと１つのサーバーが必要です。

>拡張性の高い適切なAWSサービスの組合せを選択してください。（3つ選択してください。）

*A: DynamoDBのオートスケーリング,EC2フリート,Autoscaling*

***
note:

* EC2フリートは上限までEC2のグループを自動で起動してくれるもの
* AutoScalingよりも柔軟な設定

> DynamoDBでは実際のトラフィックパターンに応じて、プロビジョニングされたスループット容量を動的に調整できます。 これにより、テーブルまたはグローバルセカンダリインデックスは、プロビジョニングされた読み取りおよび書き込み容量を増やし、スロットルなしでトラフィックの突然の増加を処理できます。 ワークロードが減少すると、Auto Scalingはスループットを低下させるため、未使用のプロビジョニング済み容量の費用はかかりません。

>EC２フリートを実施して、スポットインスタンスを設定することで、1つ以上のスケーリングポリシーに応じて、選択した範囲内でインスタンスを起動（スケールアウト）またはインスタンスを終了（スケールイン）できます。EC2 フリート を使用して、オンデマンドとスポットのターゲット目標を別個に定義し、さらに 1 時間あたりの支払い上限料金を定義し、アプリケーションに最適なインスタンスタイプを指定したり、各購入オプション内でフリート容量を Amazon EC2 で分散する方法を指定したりでき、より柔軟にAutoScaling設定を実施することが可能です。

>AutoScalingをEC２フリートに設定することで、通常のEC２インスタンス群に設定するよりも柔軟な拡張性を担保することができます。 

## 質問45
>あなたはAWSを得意としたエンジニアとして、AWS SDK for JavaとDynamoDBを使用して構築されたJavaアプリケーションの改修プロジェクトを担当しています。このアプリケーションはピーク時に多数のユーザーがアクセスし、非常に多くの書き込み処理が実施されます。書き込みが増大するにつれてDynamoDBテーブルの古いデータを上書きしてしまい、データ整合性を損なってしまう問題が発生しました。

>このトラブルに対応するために必要なソリューションを選択してください。

*A: バージョン番号にオプティミスティックロック機能を利用する*

***
note:

* オプティミスティックロックは排他制御のこと
* オプティミスティックロックを有効にするために DynamoDBVersion タグを使用してDynamoDBでも使える

>オプティミスティックロックとは、更新 (または削除) しているクライアント側の項目が、Amazon DynamoDB の項目と確実に同じになるようにするための方法です。この方法を使用すると、データベースの書き込みは、他のユーザーの書き込みによって上書きされないように保護されます。逆の場合も同様に保護されます。

## 質問46
>A社はAWS SDK for JavaとDynamoDBを使用して構築されたJavaウェブアプリケーションを構築しています。このアプリケーション構成では、複数のAWSリージョンにデータを保存するマルチリージョン構成のDynamoDBを利用しています。このアプリケーションに対して、全てのリージョンで実施されたデータ更新に対して、新しい更新内容のみを追跡・保存する処理が必要です。

>このデータ追跡機能を実装する方法を選択してください。（２つ選択してください。）

*A: DynamoDBストリームを有効にし、StreamViewTypeの値をKEYS_ONLYに設定する,*<br>
*分析アプリ側でKinesisアダプターを使用してDynamoDBからのストリームを消費する*

***
note:

* 様々なリージョンのすべてのテーブルの最近の変更を追跡・保存するリアルタイムデータ分析機能を追加で実装するために、Amazon DynamoDB からのストリームデータを取得するためのAmazon Kinesis アダプターの設定が必要
>DynamoDB ストリーム は、DynamoDB テーブル内の項目レベルの変更の時系列シーケンスをキャプチャし、この情報を最大 24 時間ログに保存します。Amazon DynamoDBストリームを消費するには、Amazon Kinesis アダプターを使用します。DynamoDB ストリーム API は、Kinesis Data Streams API と類似しており、データストリームはシャード（ストリームレコードのコンテナ）で構成されています。

>DynamoDBストリームを有効にし、StreamViewTypeの値をNEW_IMAGEに設定する必要があります。DynamoDBのテーブルのDynamoDBストリームを利用するには、StreamEnabledにおいてDynamoDBストリームが有効になっている必要があります。StreamViewTypeではテーブル内のアイテムが変更されると、StreamViewTypeは、このテーブルのストリームに書き込まれる情報を決定します。

>StreamViewTypeの有効な値は次のとおりです。

>・KEYS_ONLY-変更されたアイテムのキー属性のみがストリームに書き込まれます。<br>
・NEW_IMAGE-アイテムが変更された後に表示されるように、アイテム全体がストリームに書き込まれます。<br>
・OLD_IMAGE-変更される前のアイテム全体がストリームに書き込まれます。<br>
・NEW_AND_OLD_IMAGES-アイテムの新しいアイテム画像と古いアイテム画像の両方がストリームに書き込まれます。 

## 質問47
>A社ではEC2インスタンスとDynamoDBを連携させたWEBアプリケーションを開発しています。あなたはエンジニアとして、MFA認証の実装を行っています。アプリケーション上でMFAコードを送信するAPI呼び出しを利用し、一時的なセキュリティ認証情報を使用して、MFA認証を行います。

>この要件を達成するために利用するべきAPIを選択してください。

*A: GetSessionTokenAPI*

***
note:

* 多様素認証はGetSessionToken API!
>GetSessionToken APIによって、呼び出しから返された一時的なセキュリティ認証情報を使用して、MFA認証を必要とするAPI操作をプログラムで呼び出す仕組みを実装することができます。

> GetSessionToken APIはAWSアカウントまたはIAMユーザーの一時的な認証情報のセットを返します。資格情報は、アクセスキーID、シークレットアクセスキー、およびセキュリティトークンで構成されます。通常、MFAを使用してAmazon EC2 StopInstancesのような特定のAWS APIオペレーションへのプログラム呼び出しを保護する場合は、GetSessionTokenを使用します。 MFA対応のIAMユーザーは、GetSessionTokenを呼び出して、MFAデバイスに関連付けられているMFAコードを送信する必要があります。呼び出しから返された一時的なセキュリティ認証情報を使用して、IAMユーザーは、MFA認証を必要とするAPIオペレーションにプログラム呼び出しを行うことができます。

## 質問48
>A社では開発環境などは全てDocker形式で展開できるように、Amazon ECSのEC2起動モードを使用してアプリケーションを構築しています。インスタンスタイプやメタデータなどの特定の属性によってコンテナーインスタンスをグループ化して、指定したグループに基づいてタスクをコンテナインスタンスに配置する設定が必要です。

>コンテナインスタンスグループにタスクを設定するためのECSの機能を選択してください。

*A: クラスタークエリ言語を利用する*

***
note:

> クラスタークエリは、オブジェクトをグループ化できる式です。たとえば、アベイラビリティーゾーン、インスタンスタイプ、カスタムメタデータなどの属性でコンテナインスタンスをグループ化できます。

>グループに基づいてコンテナインスタンスのタスクを配置するように Amazon ECS をカスタマイズできます

## 質問49
>あなたはソリューションアーキテクトとして、お店の混雑状況を会員ユーザーに通知するモバイルアプリを開発中です。 このモバイルアプリは、プロバイダーのSDKとAmazon Cognitoを使用して、アイデンティティプロバイダー（IdP）で認証します。 エンドユーザーがIdPで認証されると、IdPから返されたOAuthまたはOpenID ConnectトークンがアプリからAmazon Cognitoに渡されます。

>一時的に限定された特権のAWS認証情報を提供するためにユーザーに渡される要素は次のうちどれでしょうか。

*A: Coginito ID*

***
note:

* ソーシャルログインのAWS版で使えるのがCognito　その際にはCognitoIDが提供される
* AWSのAPIへのアクセス制御をする認証プロバイダー

>Amazon Cognito は、ウェブアプリケーションやモバイルアプリケーションの認証、許可、ユーザー管理をサポートしています。ユーザーは、ユーザー名とパスワードを使用して直接サインインするか、Facebook、Amazon、Google などのサードパーティーを通じてサインインできます。

>ユーザーがAWSリソースにアクセスできるように、Amazon Cognitoを使用して一時的な特権制限付きの認証情報をアプリケーションに配信できます。 Amazon Cognito IDプールは認証済みおよび未認証の両方のIDをサポートします。 認証されていないユーザーを許可している場合、またはユーザーを認証している場合は認証情報プロバイダーでログイントークンを設定した後は、エンドユーザーの一意のAmazon Cognito識別子（ID）をすぐに取得できます。

## 質問50
>あなたの会社はEC2インスタンスのAuto ScalingグループとALBで構成されるWebアプリケーションを利用しています。HTTPSを使用してポータルのセキュリティを改善する必要があります。あなたはサードパーティ認証局（CA）からSSL / TLS証明書を利用しようと設定していましたが、設定しているリージョンではAWS Certificate Managerが利用できないようです。

>ACMが利用できない場合にSSL / TLS証明書を安全にインポートするために利用するべきAWSサービスを選択してください。

*A: IAM*

***
note:

* 通常はACMでサーバー証明書をプロビジョン、管理、およびデプロイすることがベスト
* それがリージョンなどでできない場合にのみ、IAMをHTTPS接続をサポートする証明書マネージャーとして使用できる

>IAM はプライベートキーを安全に暗号化し、暗号化されたバージョンを IAM SSL 証明書ストレージに保存します。IAM では、サーバー証明書をすべてのリージョンにデプロイできますが、証明書を AWS で使用するには、外部プロバイダーから取得する必要があります。ACM 証明書を IAM にアップロードすることはできません。また、IAM コンソールから証明書を管理することはできません。

## 質問51
>B社はAWSでサーバーレスアプリケーションを構築しています。 アプリケーションは、AWS Lambda、API Gateway、およびDynamoDBを単一のスタックで構成されており、非同期で呼び出されるLambda関数を使用する分散システムとなっています。あなたは、Lambda関数の処理に失敗した場合において、未処理のイベントをAmazon SQSキューに送信する前に、Lambda関数を2回再試行する対応を行っています。

>この要件を達成するために必要となるLambda関数の設定を選択してください。

*A: Lambda関数のDeadLetterConfigパラメータでAmazonSQSのARNを指定する*

***
note:

* DeadLetterQueueの設定をするのはDeadLetterConfigパラメータ!
* Amazon SNSトピックまたはAmazon SQSキューに送信するか設定する！

## 質問53
>開発者はSQSとDynamoDBを連携させたモバイルアプリケーションを開発しています。このモバイルアプリではユーザーがデータを更新するとSQSキューを利用して、DynamoDBへと処理メッセージが通知されます。特定のケースでSQSキューの新しいメッセージの配信を数秒間停止する処理が必要となりました。

>SQSメッセージが指定された期間、コンシューマーに見えないようにする機能を選択してください。

*A: 遅延キュー*

***
note:

* 可視性タイムアウト = SQS のキューに入ったメッセージが処理開始直後に重複して処理されないように、処理中の場合、一時的に他のプロセスからは、メッセージが存在していることを見えないようにする設定
* 遅延キューはメッセージがキューに追加されたタイミングで指定した秒数、非表示になる
* 可視性タイムアウトは処理が終わってから見えなくするが遅延キューは来たと同時に非表示にする

>遅延キューを使用すると、キューへの新しいメッセージの配信を数秒延期することができます。遅延キューを作成した場合、キューに送信したメッセージはいずれも、遅延期間の間コンシューマーに表示されなくなります。キューのデフォルトの (最小) 遅延は 0 秒です。最大は 15 分です。

>遅延キューにより、コンシューマーはメッセージを一定の時間使用できなくなるため、これは可視性タイムアウトと似ています。両者の違いは、遅延キューの場合はメッセージが最初にキューに追加されたときに非表示になるのに対し、可視性タイムアウトの場合は、メッセージがキューから処理された後のみ非表示になるという点で異なります。したがって、可視性タイムアウトは不正解

## 質問54
>あなたはAmazon ECSによりWEBアプリケーションを構築しています。このアプリケーション向けに、単一のdockerコンテナー環境がElastic Beanstalkでホストされており、アプリケーションの展開とバージョン更新に利用されています。あなたは運用担当者として、Elastic Beanstalkのデプロイ設定を行っています。要件としては移行時のパフォーマンス低下やダウンタイムを回避するために、コンピューティングリソースの全容量を維持することが求められています。 

>この要件を満たすために設定すべき展開方法を選択してください。（２つ選択してください。）

*A: Rolling with additonal batch,Immutable*

***
note:


* 一番早いが短期間止めなきゃならない

>■All at once
新しいバージョンをすべてのインスタンスに同時に展開します。 環境内のすべてのインスタンスは、展開が行われている間、短時間サービスが停止します。 これは、展開に必要な合計時間を最短にする方法です。

* 分割しながら部分ごとにデプロイする　古いほうでやってた処理は古いほうで引き継がれる

>■Rolling(ローリング)
Elastic Beanstalk は環境の EC2 インスタンスを複数のバッチに分割し、アプリケーションの新しいバージョンを一度に 1 つのバッチにデプロイするため、環境内の残りのインスタンスは古いアプリケーションバージョンを実行した状態になります。つまりローリングデプロイ中は、アプリケーションの古いバージョンでリクエストを処理するインスタンスもあり、新しいバージョンでリクエストを処理するインスタンスも存在します。

* 完全なスペースを確保してからバッチで展開する

>■Rolling with additional batch
新しいバージョンをバッチで展開しますが、最初にインスタンスの新しいバッチを起動して、展開プロセス中に完全な容量を確保します。 

* 古いのと並行しながらフルで新しいのを起動する　一番問題がない

>■Immutable
変更不可能な更新を実行して、古いバージョンを起動しているインスタンスと並行しながら、別の Auto Scaling グループにあるアプリケーションの新しいバージョンを起動している新しいインスタンスのフルセットを起動します。[Immutable] デプロイは、部分的に完了したローリングデプロイにより発生する問題を防止できます。新しいインスタンスがヘルスチェックをパスしなかった場合、Elastic Beanstalkはそれを終了し、元のインスタンスをそのまま残します。こちらも展開プロセス中に完全な容量を確保することができます。

## 質問55
>開発者はEC2インスタンスとDynamoDBを連携させたモバイルゲームアプリケーションを開発しています。このゲームは複数のモバイルデバイスを利用できるようにしたいため、モバイルデバイス間でユーザープロファイルデータを同期することが必要です。

>この要件を満たすために利用するべき機能を選択してください。

*A: AWS AppSync*

***
note:

* AppSyncはどの入り口から来たものでもデータを同期することができる
* CognitoSyncの新しいバージョンでこっちが推奨される
>AWS AppSync を使用すると、1 つ以上のデータソースからのデータに安全にアクセス、操作、結合するための柔軟な API を作成でき、アプリケーション開発がシンプルになります。AWS AppSync は、Amazon Cognito Sync のように、デバイス間でアプリケーションデータを同期するための新しいサービスであり、現在は、アプリケーション関連のユーザーデータのデバイス間の同期するためには、Amazon Cognito Sync ではなく、AWS AppSync の利用が推奨されています。

## 質問56
>A社ではEC2インスタンスのLinuxサーバーとS3ストレージから構成されるアプリケーションを運用しています。担当エンジニアはAWS KMSキーを使用した暗号化を実施しながら大容量ファイルをS3バケットにアップロードしていますが、「Access Denied (アクセス拒否)」エラーが発生してしまいました。

>この問題への対処方法を選択してください。（３つ選択してください。）

*A: エンジニアにkms:Encrypt権限を設定する,*<br>
*AWS CLIによるマルチパートアップロードを実行する,*<br>
*エンジニアにkms:Decrypt権限を設定する* 

***
note:

* EncryptとDecryptはセットで権限与える！

>KMSで設定可能なアクセス権限は以下の通りです。

>・kms:Encrypt –<br>
 キーユーザーが AWS KMS でのこの CMK によるデータの暗号化を正常にリクエストできるようにする。<br>
・kms:Decrypt – <br>
キーユーザーが AWS KMS でのこの CMK によるデータの復号を正常にリクエストできるようにする。<br>
・kms:ReEncrypt* – <br>
この CMK でもともと暗号化されたデータを AWS KMS が再暗号化すること、以前に暗号化されたデータをこの CMK で再暗号化することを、キーユーザーが正常にリクエストできるようにする。ReEncrypt API オペレーションには 2 つの CMK へのアクセスが必要です。元の CMK は復号化に使用され、もう 1 つの CMK は以降の暗号化に使用されます。これを行うには、両方の CMK に kms:ReEncrypt* アクセス権限を許可できます (アクセス権限のワイルドカード文字「*」に注意)。または、復号のため CMK で kms:ReEncryptFrom アクセス権限を許可し、暗号化のため CMK で kms:ReEncryptTo アクセス権限を許可できます。<br>
・kms:GenerateDataKey* – <br>
クライアント側の暗号化で使用するデータ暗号化キー (データキー) をキーユーザーが正常にリクエストできるようにする。キーユーザーは、データキーの 2 つのコピーを受け取る選択ができます (1 つはプレーンテキスト形式で、もう— 1 つはこの CMK で暗号化されたもの)。—または、暗号化された形式のデータキーのみを受け取ることができます。<br>
・kms:DescribeKey – <br>
キーユーザーがこの CMK に関する情報 (その識別子、作成日、状態など) を取得できるようにする。

## 質問57
>あなたはアプリ開発・導入担当として、AWS Elastic Beanstalkを利用してWEBアプリケーションを展開しています。アプリケーションはDynamoDBで多数の関連アイテムを読み書きし、各アイテムを1つずつ処理します。しかしながら、この処理によってネットワークオーバーヘッドにより、アプリケーションパフォーマンスが低下してしまいます。 あなたはエンジニアとして、これをリファクタリングするように依頼されました。

>費用対効果が高く、容易なリファクタリング方法を選択してください。

*A: DynamoDBのGET,PUT,およびDELETE操作にBatchオペレーションを利用する*

***
note:

> DynamoDB は、作成、読み込み、更新、削除 (CRUD) の 4 つの基本的なオペレーション機能を提供します。 4 つの基本的な CRUD オペレーションに加えて、DynamoDB は以下も提供します。

>・BatchGetItem — 1 つ以上のテーブルから最大 100 個の項目を読み取ります。<br> 
・BatchWriteItem — 1 つ以上のテーブルから最大 25 個の項目を作成または削除します。

* DBをBatchで処理できるのを提供してるからそれを使えばいい

## 質問59
>あなたの会社はEC2インスタンスのAuto ScalingグループとALBで構成されるWebアプリケーションを利用しています。このアプリケーションでは東京リージョンに100以上のEC2インスタンスを保持しており、高度な株価解析アルゴリズムを実行します。このアプリケーションのモニタリングではEC2インスタンスのCPU使用率とメモリ利用率を1分間隔で把握したいと考えています。 

>この要件に対応するために必要なソリューションを選択してください。（2つ選択してください。）

*A: CloudWatchのカスタムメトリクスを設定する,CloudWatchの高解像度アラームを設定する*

***
note:

* EC2インスタンスのCPU使用率とメモリ利用率を10秒間隔で把握するためには、CloudWatchのカスタムメトリクスを設定することで、CloudWatchの高解像度アラームを利用できるようにする

>カスタムメトリクスを発行するときは、標準解像度または高解像度のいずれかとして定義できます。高解像度メトリクスを発行すると、CloudWatch は 1 秒の解像度でそのメトリクスを保存します。メトリクスは 1 秒、5 秒、10 秒、30 秒、または 60 秒の倍数の期間で読み取りおよび取得できます。 またCloudWatchを利用したモニタリングにおいて、EC２インスタンスのメモリ利用率はカスタムメトリクスでないと取得できません。<br>
高解像度メトリクスを使用すれば、アプリケーションの 1 分未満のアクティビティをより迅速に把握できます。PutMetricData がカスタムメトリクスを呼び出す場合、課金されることに注意してください。そのため、高解像度で PutMetricData を頻繁に呼び出すと、高額な料金が発生する可能性があります。

## 質問61
>ヘルステックベンチャーにおいて、あなたはエンジニアとしてAWSでホストされた健康管理アプリケーションの開発を行っています。このアプリケーションは世界的にCloudFormationスタックを利用してインフラ構成を展開しています。追加の対応として、CloudFormationスタックと他のサービスとを連携して、展開プロセスを自動化するようにマネージャーから依頼されました。

>次のサービスのどれがCloudFormationに依存してリソースをプロビジョニングしていますか？ （2つ選択してください。）

*A: Elastic Beanstalk,Step Functions*

***
note:

* CloudFormationに依存してリソースをプロビジョニングしているのは、AWS Elastic BeanstalkとAWS Step Functions

>AWS Step Functions は、視覚的なワークフローを使用して、分散アプリケーションとマイクロサービスのコンポーネントを調整できるウェブサービスです。それぞれ別個の関数 (タスク) を実行する個々のコンポーネントからアプリケーションを構築することで、簡単にアプリケーションをスケールおよび変更できます。AWS Step Functions ではAWS CloudFormation を使用して AWS Step Functions のリソースをプロビジョニングしています。AWS CloudFormation は、AWS でのプロビジョニングと管理を単純化します。目的のサービスまたはアプリケーションアーキテクチャ用のテンプレートを作成し、AWS CloudFormation でそれらのテンプレートを使用して、サービスやアプリケーションを迅速かつ信頼性の高い方法でプロビジョニングできます。

## 質問62
>A社ではアプリケーション開発においてAWSのcodeシリーズと呼ばれるAWS CodeCommitとAWS CodePiplineなどを利用して開発・テスト・デプロイまでのパイプラインを利用したCI/CD環境を整備しています。開発者はコードの変更を定期的にAWS CodeCommitリポジトリにマージしており、CodeCommitの変更に反応するルールを設定したいと考えています。 

>このタイプの統合で利用するAWSサービスを選択してください。

*A: Cloudwatchイベント*

***
note:

* CloudWatchイベントを利用することでCodeCommitの変更をトリガーにして、何らかのアクションを設定することができる

## 質問63
>あなたはソリューションアーキテクトとして、AWS上にWEBアプリケーションを構築しています。この アプリケーションは、複雑な読み取りおよび書き込みデータベース操作を処理するためにRDSインスタンスを頻繁に使用しています。社内のコンプライアンス要件を満たすためには、毎月のデータベースバックアップを３カ月間保持する必要があります。

>要件を満たすのに役立つソリューションは次のうちどれですか？

*A: CloudWatchでcronイベントを作成し、スナップショット機能をトリガーするLambdaを利用する*

***
note:

* CLIから作ったRDSのデフォルトのバックアップ保持期間は 1 日
* コンソールからだとデフォルトのバックアップ保持期間は 7 日
* **バックアップ保持期間は、0 ～ 35 日間で設定できる**

>この制限をこえてバックアップを自動取得するためには、Lambda関数を利用した自動取得を設定することが必要です。CloudWatchでcronイベントを作成し、スナップショット機能をトリガーするAWS Lambda関数を利用することで、35日を超えて、バックアップを保持する仕組みをつくることができます。

## 質問64
>あなたの会社はSQSキューメッセージをLambdaが受け取って処理するサーバーレスアプリケーションを構築することで、既存アプリケーションサーバーの業務処理を効率化する対応を行っています。このサーバレスアプリケーションの実現のためには、SQSキュー内で指定されたメッセージを削除する仕組みが必要です。

>この要件を満たすSQSの設定を選択してください。

*A: PurgeQueueを使用する*

***
note:

* 指定されたメッセージを削除する => PurgeQueue

>PurgeQueueを利用するとQueueURLパラメーターで指定されたキュー内のメッセージを削除します。QueueURLパラメーターでメッセージを指定することができるため、削除する際にキューの再構成が不要です。

>DeleteQueueを利用するとキューの内容に関係なく、QueueUrlで指定されたキューを削除してしまいます。

## 質問65
>DynamoDBテーブルのデータ処理を実施するアプリケーションにおいて、DynamoDBテーブルへの読み取り操作と書き込み操作の両方が抑制されているため、アプリケーションでエラーが発生しています。調査の結果、データアクセスが不均等であり、他のパーティションと比較して、特定のパーティションに大容量の読み書きトラフィックが送信されていることがわかりました。

>この問題を解決するコスト最適なアプローチを選択してください。（2つ選択してください。）

*A: エラーの再試行と指数バックオフを実装する*<br>
*I/Oリクエストを均等に分散するリファクタリングを実施する*

***
note:

>DynamoDBなどのネットワーク環境でスロットルにかかるエラー応答を処理するための通常の手法は、クライアントアプリケーションに再試行を実装することです。 この手法により、アプリケーションの信頼性が向上し、開発者の運用コストが削減されます。 各AWS SDKは、自動再試行ロジックを実装しています。Exponential Backoffは指数関数的に処理のリトライ間隔を後退させるアルゴリズムのことです。これを実装することで一時的にリソースを超過したリクエストが来ても特定のスロットリング機構なしでリクエストが最終的に処理することができます。

>I/O リクエストを均等に分散するリファクタリングを実施することでも解消されます。テーブルの主キーのパーティションキー部分は、テーブルのデータが格納されている論理パーティションを決定します。これにより、基本的な物理パーティションに影響を及ぼします。テーブルのプロビジョニングされた I/O キャパシティーは、これらの物理パーティション間で均等に分割されます。そのため、I/O リクエストを均等に分散しないパーティションキー設計では、「ホット」パーティションが作成される場合があります。これにより、スロットリングが発生したり、プロビジョニングされた I/O キャパシティーを効率的に使用されないことがあります。
